(this["webpackJsonpappalti190-client"]=this["webpackJsonpappalti190-client"]||[]).push([[16],{307:function(e,t,o){"use strict";o.d(t,"b",(function(){return j})),o.d(t,"a",(function(){return v})),o.d(t,"g",(function(){return h})),o.d(t,"d",(function(){return f})),o.d(t,"f",(function(){return O})),o.d(t,"e",(function(){return m})),o.d(t,"c",(function(){return p})),o.d(t,"h",(function(){return x}));var n=o(0),a=o.n(n),c=o(286),i=o(297),l=o(366),r=o(293),s=o(475),d=o(14);var u=o(1),b=Object(c.a)((function(e){return{paragraph:{fontSize:"1.1em"},paragraphSmall:{fontSize:"0.8em"},centered:{display:"flex",justifyContent:"center",alignItems:"center"},justified:{textAlign:"justify"},box:{display:"flex"},boxLeft:{justifyContent:"flex-start"},boxRight:{justifyContent:"flex-end"},sup:{fontSize:"0.8em"},scrollableContainer:{display:"flex",flexDirection:"column",marginTop:"1em",minHeight:"5em"},scrollable:{height:"100%",overflowY:"auto",paddingLeft:10,paddingRight:10,minHeight:"3em"},attention:{backgroundColor:e.palette.attention.main,color:"white",fontWeight:"bold"}}})),j=a.a.memo((function(e){return Object(u.jsx)("div",{children:e.children})}));j.defaultProps={};var v=a.a.memo((function(e){var t=b(),o=function(){var e=Object(n.useState)({width:window.innerWidth,height:window.innerHeight}),t=Object(d.a)(e,2),o=t[0],a=t[1];return Object(n.useEffect)((function(){function e(){a({width:window.innerWidth,height:window.innerHeight})}return window.addEventListener("resize",e),e(),function(){return window.removeEventListener("resize",e)}}),[]),o}();return Object(u.jsx)("div",{className:t.scrollableContainer,children:Object(u.jsx)("div",{className:t.scrollable,style:{margin:"auto",width:"90%",height:Math.max(120,o.height-90-100-90)},children:e.children})})}));v.defaultProps={};var h=a.a.memo((function(e){var t=b();return Object(u.jsx)("div",{className:t.centered,children:Object(u.jsx)("h2",{children:e.children})})}));h.defaultProps={};var f=a.a.memo((function(e){var t=b();return Object(u.jsx)(l.a,{mb:1,children:Object(u.jsx)(i.a,{component:"div",className:"".concat(t.paragraph," ").concat(t.justified," ").concat(e.small?t.paragraphSmall:null," ").concat(e.class),children:e.children})})}));f.defaultProps={class:null};var O=a.a.memo((function(e){var t=b();return Object(u.jsx)(l.a,{component:"span",m:1,className:"".concat(t.reset),children:Object(u.jsx)(r.a,{variant:"contained",title:e.title,color:"attention",className:t.attention,onClick:e.onClick,disabled:e.isDisabled,children:e.children})})}));O.defaultProps={isDisabled:!1};var m=a.a.memo((function(e){var t=b();return Object(u.jsx)(l.a,{component:"span",m:1,className:"".concat(t.box," ").concat(t.boxLeft),children:Object(u.jsx)(r.a,{variant:"contained",color:"secondary",onClick:e.onPrev,disabled:!e.prevIsEnabled,children:e.children})})}));m.defaultProps={};var p=a.a.memo((function(e){var t=b();return Object(u.jsx)(l.a,{component:"span",m:1,className:"".concat(t.box," ").concat(t.boxRight),children:Object(u.jsx)(r.a,{variant:"contained",color:"secondary",onClick:e.onNext,disabled:!e.nextIsEnabled,children:e.children})})}));p.defaultProps={};var x=a.a.memo((function(e){var t=b();return Object(u.jsx)(s.a,{title:e.title,placement:"top",children:Object(u.jsx)("sup",{className:t.sup,children:e.anchor})})}));x.defaultProps={anchor:"*"}},308:function(e,t,o){"use strict";var n=o(21),a=o(311),c=o(0),i=o.n(c),l=o(293),r=o(417),s=o(384),d=o(418),u=o(419),b=o(420),j=o(1),v=["title","contentText","actions"],h=function(e){var t=e.title,o=e.contentText,c=e.actions,i=Object(a.a)(e,v);return Object(j.jsxs)(r.a,Object(n.a)(Object(n.a)({},i),{},{onBackdropClick:function(){},"aria-labelledby":t,onClose:function(e,t){},children:[Object(j.jsx)(s.a,{children:t}),Object(j.jsx)(d.a,{children:Object(j.jsx)(u.a,{children:o})}),Object(j.jsx)(b.a,{children:c.map((function(e,t){return Object(j.jsx)(l.a,{onClick:function(){e.callback&&e.callback(),e.closeModal&&i.onClose()},variant:"primary"===e.variant?"contained":"secondary"===e.variant?"outlined":"contained",autoFocus:i,style:{textTransform:"none"},children:e.text},t)}))})]}))};h.defaultProps={title:"",contentText:"",actions:[{text:"Ok",closeModal:!0,callback:function(){},variant:"primary",autoFocus:!1}]},t.a=i.a.memo(h)},315:function(e,t,o){"use strict";var n=o(105),a=o(88),c=o.n(a),i=o(31),l=o(45),r=function(){var e=Object(n.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l.a.getUser()){e.next=3;break}return e.abrupt("return",null);case 3:return e.next=5,i.a.get("/job/get");case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),s={get:r,set:function(e){return l.a.getUser()?i.a.put("/job/set",{job:e}):null},upload:function(e){var t=new FormData;return t.append("file",e),i.a.post("/job/upload",t,{headers:{"Content-Type":"multipart/form-data"}})},transformXls2Xml:function(e){return i.a.post("/job/transformXls2Xml/:filePath",{filePath:e})},validateXml:function(e){return i.a.post("/job/validateXml/:transform",{transform:e})},outcomeCheck:function(e,t){return i.a.post("/job/outcomeCheck/:anno/:codiceFiscaleAmministrazione",{anno:e,codiceFiscaleAmministrazione:t})},outcomeFailureDetails:function(e,t){return i.a.post("/job/outcomeFailureDetails/anno/codiceFiscaleAmministrazione",{anno:e,codiceFiscaleAmministrazione:t})},urlExistenceAndMatch:function(e,t){return console.log("*** jobService - url,fileToMatch:",e,t),i.a.post("/job/urlExistenceAndMatch/url/fileToMatch",{url:e,fileToMatch:t})},getPlans:function(){return i.a.get("/job/getPlans")}};t.a=s},461:function(e,t,o){"use strict";o.r(t);var n=o(0),a=o.n(n),c=o(286),i=o(14),l=o(21),r=o(311),s=o(295),d=o(472),u=o(298),b=o(302),j=o(462),v=o(473),h=o(297),f=o(366),O=o(45),m=o(315),p=o(307),x=o(1);function g(e){var t=Object(s.a)().t,o=Object(n.useState)(!0),a=Object(i.a)(o,1)[0];return Object(x.jsxs)(p.b,{children:[Object(x.jsxs)(p.a,{children:[Object(x.jsx)(p.g,{children:t("Welcome!")}),Object(x.jsxs)(p.d,{children:[t("This is our proposal to fulfill the requirements of the")," "," ",Object(x.jsx)("a",{href:"https://www.anticorruzione.it/-/adempimenti-legge-190/2012-art.-1-comma-32-7",target:"legge190",children:t("Legge 190")}),"."," ",t("We hope it is clear and simple to use"),"."]}),Object(x.jsxs)(p.d,{children:[t("This app will walk you through the few steps you need to complete the fulfillment successfully"),"."]}),Object(x.jsxs)(p.d,{children:[t("To get started you'll need to download an Excel template"),Object(x.jsx)(p.h,{title:t("It can be in MicroSoft-Excel format, or in ODS format")+"."}),","," ",t("which contains rules to guide you in the compilation, and minimize possible formal errors"),"."]}),Object(x.jsxs)(p.d,{children:[t("Then you will have to enter, one per line, all the goods or services that your structure has contracted out in the current year"),"."]}),Object(x.jsxs)(p.d,{children:[t("At the end of the year, generally by the end of January of the following year, it will be sufficient to upload the filled Excel sheet here"),"."]}),Object(x.jsxs)(p.d,{children:[t("At this point our system will carry out the formal check of the entered data"),".",t("In the event that some anomaly is reported, you will have to correct the reported anomalies in the Excel file, and then re-upload it"),"."]}),Object(x.jsxs)(p.d,{children:[t("You will then be able to download the XML document produced, which will be published on the site your structure refers to"),"."]}),Object(x.jsxs)(p.d,{children:[t("At this point you will have practically completed the fulfillment"),".",t("If you want, you can check - again on this site - the outcome of the verification by the ANAC"),"."]}),Object(x.jsxs)(p.d,{children:[t("Please note that we are always available to answer you for any doubts or uncertainties"),".",t("The assistance methods are different, from telephone support to email support, and also depend on the plan chosen"),".",t('References can be found in the menu under "Support"'),"."]})]}),Object(x.jsx)("div",{children:Object(x.jsx)(p.c,{onNext:function(){e.goto("next")},nextIsEnabled:a,children:t("Continue")})})]})}g.defaultProps={};var y=a.a.memo(g),w=o(18),I=o(108),A=o(291),C=o(293),k=o(60),T=o(308),E=o(20),P=o.n(E),S=o(76);function R(e){var t=Object(s.a)().t,o=Object(w.f)(),a=Object(n.useState)(!0),c=Object(i.a)(a,1)[0],r=Object(n.useState)((function(){var t;return!(null===(t=e.job)||void 0===t||!t.downloadTemplate)})),d=Object(i.a)(r,2),u=d[0],b=d[1],j=Object(I.b)().showModal,v=function(){return!!k.a.getCurrentUser()||(function(e){j(T.a,e)}({title:t("Please log in or register"),contentText:t("You need to be authenticated to proceed"),actions:[{text:t("Login"),closeModal:!0,autoFocus:!0,callback:function(){O.a.set("redirect",e.tabId),o.push("/signin")}},{text:t("Register"),closeModal:!0,callback:function(){O.a.set("redirect",e.tabId),o.push("/signup")}},{text:t("Cancel"),closeModal:!0,callback:function(){return e.goto("prev")}}]}),!1)};return Object(x.jsxs)(p.b,{children:[Object(x.jsxs)(p.a,{children:[Object(x.jsx)(p.g,{children:t("Download")}),Object(x.jsx)(p.d,{children:"Scarica il modello Excel in cui potrai inserire i dati degli appalti, uno per riga."}),Object(x.jsx)(p.d,{children:Object(x.jsxs)(C.a,{onClick:function(){var t;v()&&(Object(S.d)(P.a.data.templateDownloadUrl),b(!0),e.setJob(Object(l.a)(Object(l.a)({},e.job),{},{downloadTemplate:!0,template:Object(l.a)(Object(l.a)({},null===(t=e.job)||void 0===t?void 0:t.template),{},{downloaded:!0})})))},variant:"contained",color:"tertiary",children:[t("Download")," \u2b07"]})})]}),Object(x.jsxs)(A.a,{container:!0,children:[Object(x.jsx)(A.a,{item:!0,xs:6,children:Object(x.jsx)(p.e,{onPrev:function(){e.goto("prev")},prevIsEnabled:c,children:t("Back")})}),Object(x.jsx)(A.a,{item:!0,xs:6,children:Object(x.jsx)(p.c,{onNext:function(){e.goto("next")},nextIsEnabled:u,children:t("Continue")})})]})]})}R.defaultProps={};var N=a.a.memo(R),U=Object(c.a)((function(e){return{ul:{paddingHorizontal:25}}}));function D(e){var t=U(),o=Object(s.a)().t,a=Object(n.useState)(!0),c=Object(i.a)(a,1)[0],l=Object(n.useState)(!0),r=Object(i.a)(l,1)[0];return Object(x.jsxs)(p.b,{children:[Object(x.jsxs)(p.a,{children:[Object(x.jsx)(p.g,{children:o("Fill your data")}),Object(x.jsxs)(p.d,{children:[o("Now you can open the downloaded template with your spreadsheet program"),"."]}),Object(x.jsxs)(p.d,{children:[o('There are 2 sheets: "METADATI" and "ELENCO GARE"'),".",Object(x.jsx)("br",{}),o('We advise you to start from the first sheet, "METADATI", and enter the 4 general data required:'),Object(x.jsxs)("ul",{className:t.ul,children:[Object(x.jsxs)("li",{children:[Object(x.jsx)("i",{children:"codiceFiscaleStrutturaProponente"})," ",o("the tax code of your company")]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("i",{children:"denominazioneStrutturaProponente"})," ",o("the business name of your company")]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("i",{children:"annoRiferimento"})," ",o("the reference year for which you will enter contracts")]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("i",{children:"urlFile"})," ",o("the URL address where the final document will be published")]})]})]}),Object(x.jsxs)(p.d,{children:[o('At this point you can move on to the second sheet, "ELENCO GARE"'),".",Object(x.jsx)("br",{}),o('Each contract (or "tender") must be entered, one per line'),"."]}),Object(x.jsxs)(p.d,{children:[o("The fields to fill in are:"),Object(x.jsxs)("ul",{className:t.ul,children:[Object(x.jsxs)("li",{children:[Object(x.jsx)("i",{children:"CIG"})," ",o("the Tender Identification Code: a unique code that identifies each tender")]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("i",{children:"OGGETTO"})," ",o("the object of the tender")]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("i",{children:"SCELTA CONTRAENTE"})," ",o("the type of contractor; it must be chosen from a predefined list, available in the sheet")]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("i",{children:"PARTECIPANTI / AGGREGATO o SINGOLO"})," ",o("the type of participant: aggregate (A) or individual (S)")]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("i",{children:"PARTECIPANTI / COD. FISCALE o ID. ESTERO"})," ",o("the participant's tax code (or foreign ID if not Italian)")]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("i",{children:"PARTECIPANTI / RAGIONE SOCIALE"})," ",o("the partecipant's business name")]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("i",{children:"PARTECIPANTI / RUOLO"})," ",o("the role of the participant; it must be chosen from a predefined list, available in the sheet")]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("i",{children:"AGGIUDICATARI"})," ",o("indicates whether the participant(s) are awarded the contract (S), or not (empty)")]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("i",{children:"IMPORTO AGGIUDICAZIONE"})," ",o("the contract award amount")]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("i",{children:"DATA INIZIO"})," ",o("the date of the award of the contract")]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("i",{children:"DATA ULTIMAZIONE"})," ",o("the date of completion of the contract")]}),Object(x.jsxs)("li",{children:[Object(x.jsx)("i",{children:"IMPORTO DELLE SOMME LIQUIDATE"})," ",o("the amount of the liquidated amount")]})]})]})]}),Object(x.jsxs)(A.a,{container:!0,children:[Object(x.jsx)(A.a,{item:!0,xs:6,children:Object(x.jsx)(p.e,{onPrev:function(){e.goto("prev")},prevIsEnabled:c,children:o("Back")})}),Object(x.jsx)(A.a,{item:!0,xs:6,children:Object(x.jsx)(p.c,{onNext:function(){e.goto("next")},nextIsEnabled:r,children:o("Continue")})})]})]})}D.defaultProps={};var F=a.a.memo(D),L=o(105),M=o(88),z=o.n(M),J=o(77),X=o(412),G=["onClick","onBlur","onDragEnter","onDragLeave","onDragOver","onDrop","onFocus","onKeyDown"],W={flex:1,display:"flex",flexDirection:"column",alignItems:"center",padding:"20px",borderWidth:2,borderRadius:10,borderColor:"#64a36f",borderStyle:"dashed",backgroundColor:"#cef0b9",color:"#353535",outline:"none",transition:"border .24s ease-in-out"},_={backgroundColor:"#d3f6d1",borderColor:"#a7d7c5"},B={backgroundColor:"lightgreen",borderColor:"darkgreen"},q={backgroundColor:"lightred",borderColor:"darkred"},V={backgroundColor:"lightgray",borderColor:"darkgray",fontStyle:"italic"},Y=function(e){var t=e.drop,o=e.accept,a=e.disabled,c=Object(s.a)().t,i=Object(X.a)({onDrop:t,accept:o}),d=i.getRootProps,u=i.isFocused,b=i.isDragAccept,j=i.isDragReject,v=i.isDragActive,h=Object(n.useMemo)((function(){return Object(l.a)(Object(l.a)(Object(l.a)(Object(l.a)({},W),a?V:u?_:{}),a?V:b?B:{}),a?V:j?q:{})}),[u,b,j,a]),f=d({style:h}),O=(f.onClick,f.onBlur,f.onDragEnter,f.onDragLeave,f.onDragOver,f.onDrop,f.onFocus,f.onKeyDown,Object(r.a)(f,G)),m={};return m=a?O:d({style:h}),Object(x.jsx)("div",Object(l.a)(Object(l.a)({className:"dropzone-div"},m),{},{children:Object(x.jsx)("div",{className:"text-center",children:a?Object(x.jsx)("p",{children:c("Remove file to load a new one")}):v?Object(x.jsx)("p",{className:"dropzone-content",children:c("Release to drop the files here")}):Object(x.jsx)("p",{className:"dropzone-content",children:c("Drag 'n drop some files here, or click to select files")})})}))};Y.defaultProps={disabled:!1};var H=Y;function K(e){var t,o,a,c,r,d,u,b=Object(s.a)().t,j=Object(w.f)(),v=Object(n.useState)(!0),h=Object(i.a)(v,1)[0],f=Object(n.useState)(!(null===e||void 0===e||null===(t=e.job)||void 0===t||!t.file)),g=Object(i.a)(f,2),y=g[0],C=g[1],E=Object(I.b)().showModal,P=Object(n.useState)([".csv","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel"]),R=Object(i.a)(P,1)[0],N=function(){return!!k.a.getCurrentUser()||(function(e){E(T.a,e)}({title:b("Please log in or register"),contentText:b("You need to be authenticated to proceed"),actions:[{text:b("Login"),closeModal:!0,autoFocus:!0,callback:function(){O.a.set("redirect",e.tabId),j.push("/signin")}},{text:b("Register"),closeModal:!0,callback:function(){O.a.set("redirect",e.tabId),j.push("/signup")}},{text:b("Cancel"),closeModal:!0,callback:function(){return e.goto("prev")}}]}),!1)},U=Object(n.useCallback)((function(){return N()}),[]);Object(n.useEffect)((function(){U()}),[U]);var D=Object(n.useCallback)(function(){var t=Object(L.a)(z.a.mark((function t(o){return z.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.setJob(Object(l.a)(Object(l.a)({},e.job),{},{file:o}));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),[e]),F=Object(n.useCallback)(Object(L.a)(z.a.mark((function t(){var o;return z.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(o={}).tabId=e.job.tabId,e.setJob(o),C(!1);case 4:case"end":return t.stop()}}),t)}))),[e]),M=Object(n.useCallback)((function(e){var t,o,n,a;return null!==e&&void 0!==e&&null!==(t=e.type)&&void 0!==t&&null!==(o=t.split("/")[1])&&void 0!==o&&o.match("officedocument.spreadsheetml.sheet")||null!==e&&void 0!==e&&null!==(n=e.type)&&void 0!==n&&null!==(a=n.split("/")[1])&&void 0!==a&&a.match("ms-excel")?null:b("Please upload a spreadsheet")+"."+(null!==e&&void 0!==e&&e.type?" "+b("Selected file looks like {{fileType}}",{fileType:e.type}):"")}),[b]),X=Object(n.useCallback)(function(){var t=Object(L.a)(z.a.mark((function t(o){return z.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,m.a.upload(o).then((function(e){console.log("Upload success, file path",e.data.file),D(e.data.file)}),(function(t){console.error("Upload error:",t),F(),e.setJob(Object(l.a)(Object(l.a)({},e.job),{},{file:{error:Object(S.g)(t)}})),J.b.error(Object(S.g)(t))}));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),[e,D,F]),G=Object(n.useCallback)(function(){var t=Object(L.a)(z.a.mark((function t(o){return z.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!o){t.next=13;break}if(!M(o)){t.next=7;break}e.setJob(Object(l.a)(Object(l.a)({},e.job),{},{file:null})),C(!1),t.next=11;break;case 7:return e.setJob(Object(l.a)(Object(l.a)({},e.job),{},{file:o})),t.next=10,X(o);case 10:C(!0);case 11:t.next=16;break;case 13:J.b.error(b("No file selected, sorry... Please, repeat...")),e.setJob(Object(l.a)(Object(l.a)({},e.job),{},{file:null})),C(!1);case 16:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),[e,X,M,b]),W=Object(n.useCallback)((function(e){console.log("accepted files:",e),G(e[0])}),[G]),_=function(){var t=Object(L.a)(z.a.mark((function t(){return z.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.goto("next");case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return Object(x.jsxs)(p.b,{children:[Object(x.jsxs)(p.a,{children:[Object(x.jsx)(p.g,{children:b("Upload")}),Object(x.jsx)(p.d,{children:b("Load filled spreadsheet")}),Object(x.jsxs)("div",{className:"container",children:[Object(x.jsx)(H,{drop:W,accept:R,disabled:!(null===e||void 0===e||null===(o=e.job)||void 0===o||null===(a=o.file)||void 0===a||!a.originalname)}),Object(x.jsx)("br",{}),Object(x.jsx)(p.d,{children:(null===e||void 0===e||null===(c=e.job)||void 0===c||null===(r=c.file)||void 0===r?void 0:r.originalname)&&Object(x.jsxs)(x.Fragment,{children:[b("Selected file"),": ",Object(x.jsx)("b",{children:null===e||void 0===e||null===(d=e.job)||void 0===d||null===(u=d.file)||void 0===u?void 0:u.originalname}),"\u2003",Object(x.jsxs)(p.f,{onClick:F,title:b("Remove uploaded file, and restart the whole process"),children:[b("Remove")," \ud83d\uddd1"]})]})})]})]}),Object(x.jsxs)(A.a,{container:!0,children:[Object(x.jsx)(A.a,{item:!0,xs:6,children:Object(x.jsx)(p.e,{onPrev:function(){e.goto("prev")},prevIsEnabled:h,children:b("Back")})}),Object(x.jsx)(A.a,{item:!0,xs:6,children:Object(x.jsx)(p.c,{onNext:_,nextIsEnabled:y,children:b("Continue")})})]})]})}K.defaultProps={};var $=a.a.memo(K),Z=o(465),Q=o(476),ee=o(477),te=o(414),oe=o(415),ne=o(389),ae=o.n(ne),ce=Object(c.a)((function(e){return{"& .MuiTypography-root":{_fontSize:"0.5em"},accordionRoot:{_height:"4em",_padding:0,_margin:0,fontSize:"0.9em"},danger:{color:e.palette.error.dark,fontWeight:"bold"}}}));function ie(e){var t,o,a,c,r,d,u,b,j,v,f=Object(s.a)().t,g=ce(),y=Object(w.f)(),C=O.a.getUser(),k=Object(n.useState)({}),E=Object(i.a)(k,2),S=E[0],R=E[1],N=Object(n.useState)([]),U=Object(i.a)(N,2),D=U[0],F=U[1],M=Object(n.useState)({}),J=Object(i.a)(M,2),X=J[0],G=J[1],W=Object(n.useState)("OK"===(null===(t=e.job)||void 0===t||null===(o=t.transform)||void 0===o?void 0:o.code)),_=Object(i.a)(W,2),B=_[0],q=_[1],V=Object(n.useState)(!0),Y=Object(i.a)(V,1)[0],H=Object(I.b)().showModal;Object(n.useEffect)((function(){var t,o,n,a,c,i,r,s,d,u,b,j;null!==(t=e.job)&&void 0!==t&&t.transform&&(null!==(o=e.job)&&void 0!==o&&null!==(n=o.transform)&&void 0!==n&&n.truncatedDueToPlanLimit&&(null!==(a=e.job)&&void 0!==a&&null!==(c=a.transform)&&void 0!==c&&c.planUpgradeDeclined||function(e){H(T.a,e)}({title:f("Please upgrade your plan"),contentText:f("You need to upgrade your plan to proceed.")+"\n"+f('Your current plan is "{{planName}}".',{planName:null===C||void 0===C||null===(i=C.plan)||void 0===i?void 0:i.name})+"\n"+f('To elaborate {{cigCount}} CIGs you need at least plan "{{planName}}"',{cigCount:null===(r=e.job)||void 0===r||null===(s=r.transform)||void 0===s?void 0:s.cigCount,planName:null===(d=e.job)||void 0===d||null===(u=d.transform)||void 0===u||null===(b=u.planRequired)||void 0===b?void 0:b.name}),actions:[{text:f("Upgrade plan"),closeModal:!0,autoFocus:!0,callback:function(){O.a.set("redirect",e.tabId),y.push("/profile",{tabValue:1})}},{text:f("Proceed with the first {{cigNumberAllowed}} CIGs",{cigNumberAllowed:null===C||void 0===C||null===(j=C.plan)||void 0===j?void 0:j.cigNumberAllowed}),closeModal:!0,callback:function(){var t;e.setJob(Object(l.a)(Object(l.a)({},e.job),{},{transform:Object(l.a)(Object(l.a)({},null===(t=e.job)||void 0===t?void 0:t.transform),{},{planUpgradeDeclined:!0})}))}}]})))}),[null===(a=e.job)||void 0===a?void 0:a.transform]),Object(n.useEffect)((function(){e.job.file&&!e.job.transform&&Object(L.a)(z.a.mark((function t(){return z.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return R(Object(l.a)(Object(l.a)({},S),{},{loading:"transform"})),R((function(e){return Object(l.a)(Object(l.a)({},e),{},{loading:"transform"})})),t.next=4,m.a.transformXls2Xml(e.job.file.path).then((function(t){if(console.log("JobService.transformXls2Xml response:",t),R((function(e){return Object(l.a)(Object(l.a)({},e),{},{loading:null})})),"OK"!==t.data.result.code)return e.setJob(Object(l.a)(Object(l.a)({},e.job),{},{transform:t.data.result})),R((function(e){return Object(l.a)(Object(l.a)({},e),{},{error:t.data.result.message})}));e.setJob(Object(l.a)(Object(l.a)({},e.job),{},{transform:t.data.result})),R((function(e){return Object(l.a)(Object(l.a)({},e),{},{success:"transform"})})),K(t.data.result),q(0===le().length)}),(function(t){return console.log("JobService.transformXls2Xml error:",t),e.setJob(Object(l.a)(Object(l.a)({},e.job),{},{transform:t})),G((function(e){return Object(l.a)(Object(l.a)({},e),{},{error:t})}))}));case 4:case"end":return t.stop()}}),t)})))()}),[]),Object(n.useEffect)((function(){var t,o,n,a,c;null===(t=e.job)||void 0===t||!t.file||null===(o=e.job)||void 0===o||!o.transform||"OK"!==(null===(n=e.job)||void 0===n||null===(a=n.transform)||void 0===a?void 0:a.code)||null!==(c=e.job)&&void 0!==c&&c.validateXml||Object(L.a)(z.a.mark((function t(){return z.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return R((function(e){return Object(l.a)(Object(l.a)({},e),{},{loading:"validateXml"})})),t.next=3,m.a.validateXml(e.job.transform).then((function(t){if(R((function(e){return Object(l.a)(Object(l.a)({},e),{},{loading:null})})),"OK"!==t.data.result.code)return e.setJob(Object(l.a)(Object(l.a)({},e.job),{},{validateXml:t.data.result})),R((function(e){return Object(l.a)(Object(l.a)({},e),{},{error:t.data.result.message})}));e.setJob(Object(l.a)(Object(l.a)({},e.job),{},{validateXml:null===t||void 0===t?void 0:t.data.result})),R((function(e){return Object(l.a)(Object(l.a)({},e),{},{success:"validateXml"})})),$(null===t||void 0===t?void 0:t.data.result)}),(function(t){return e.setJob(Object(l.a)(Object(l.a)({},e.job),{},{validateXml:t})),G((function(e){return Object(l.a)(Object(l.a)({},e),{},{error:t})}))}));case 3:case"end":return t.stop()}}),t)})))()}),[e.job.transform]),Object(n.useEffect)((function(){e.job.validateXml&&ne()}),[e.job]);var K=function(e){var t,o,n=null!==X&&void 0!==X?X:{};if(n.results=n.results?n.results:[],null!==e&&void 0!==e&&null!==(t=e.warnings)&&void 0!==t&&t.length){var a=null===e||void 0===e?void 0:e.warnings.map((function(e,t){return{type:"TRANSFORM_WARNING",header:"".concat(f("transformation warning")," ").concat(t+1),content:e}}));n.results=n.results.concat(a)}if(null!==e&&void 0!==e&&null!==(o=e.errors)&&void 0!==o&&o.length){var c=null===e||void 0===e?void 0:e.errors.map((function(e,t){return{type:"TRANSFORM_ERRPR",header:"".concat(f("transformation error")," ").concat(t+1),content:e}}));n.results=n.results.concat(c)}G((function(e){return Object(l.a)(Object(l.a)({},e),{},{results:n.results})}))},$=function(e){var t=null!==X&&void 0!==X?X:{};if(t.results=t.results?t.results:[],null!==e&&void 0!==e&&e.message){var o=e.message.split("\n"),n=/^\t\[([^\]]+)\]\s*([^:]*):\s*(.*)$/;o.shift(),o=o.map((function(e){return{type:"VALIDATE_XML_ERROR",header:"xml validation ".concat(e.replace(n,"$1"),": ").concat(e.replace(n,"$2")),content:e.replace(n,"$3")}})),t.results=t.results.concat(o)}G((function(e){return Object(l.a)(Object(l.a)({},e),{},{results:t.results})}))},ne=function(){var t,o,n,a,c,i,l,r,s,d,u,b,j,v,h,O,m,p,x,g,y,w,I,A,C,k,T,E,S,R,N,U=[];null!==(t=e.job)&&void 0!==t&&t.file&&(U[f("Original file name")]=e.job.file.originalname),null!==(o=e.job)&&void 0!==o&&null!==(n=o.transform)&&void 0!==n&&null!==(a=n.metadati)&&void 0!==a&&a.titolo&&(U[f("Title")]=e.job.transform.metadati.titolo),null!==(c=e.job)&&void 0!==c&&null!==(i=c.transform)&&void 0!==i&&null!==(l=i.metadati)&&void 0!==l&&l.abstract&&(U[f("Abstract")]=e.job.transform.metadati.abstract),null!==(r=e.job)&&void 0!==r&&null!==(s=r.transform)&&void 0!==s&&null!==(d=s.metadati)&&void 0!==d&&d.dataPubblicazioneDataset&&(U[f("Dataset publish date")]=e.job.transform.metadati.dataPubblicazioneDataset),null!==(u=e.job)&&void 0!==u&&null!==(b=u.transform)&&void 0!==b&&null!==(j=b.metadati)&&void 0!==j&&j.dataUltimoAggiornamentoDataset&&(U[f("Dateset last update date")]=e.job.transform.metadati.dataUltimoAggiornamentoDataset),null!==(v=e.job)&&void 0!==v&&null!==(h=v.transform)&&void 0!==h&&null!==(O=h.metadati)&&void 0!==O&&O.entePubblicatore&&(U[f("Publishing body")]=e.job.transform.metadati.entePubblicatore),null!==(m=e.job)&&void 0!==m&&null!==(p=m.transform)&&void 0!==p&&null!==(x=p.metadati)&&void 0!==x&&x.annoRiferimento&&(U[f("Reference year")]=e.job.transform.metadati.annoRiferimento),null!==(g=e.job)&&void 0!==g&&null!==(y=g.transform)&&void 0!==y&&null!==(w=y.metadati)&&void 0!==w&&w.urlFile&&(U[f("Url file")]=e.job.transform.metadati.urlFile),null!==(I=e.job)&&void 0!==I&&null!==(A=I.transform)&&void 0!==A&&A.rownum&&(U[f("Number of source rows")]=e.job.transform.rownum),null!==(C=e.job)&&void 0!==C&&null!==(k=C.transform)&&void 0!==k&&k.cigCount&&(U[f("Number of CIGs")]=null===(T=e.job.transform)||void 0===T?void 0:T.cigCount),null!==(E=e.job)&&void 0!==E&&null!==(S=E.transform)&&void 0!==S&&S.importoAggiudicazioneTotale&&(U[f("Total award amount")]="".concat(P.a.currency.default," ").concat(e.job.transform.importoAggiudicazioneTotale)),null!==(R=e.job)&&void 0!==R&&null!==(N=R.transform)&&void 0!==N&&N.importoSommeLiquidateTotale&&(U[f("Total liquidated amount")]="".concat(P.a.currency.default," ").concat(e.job.transform.importoSommeLiquidateTotale)),F(U)},ie=function(){var e,t;return null!==(e=null===(t=X.results)||void 0===t?void 0:t.filter((function(e){return"TRANSFORM_WARNING"===e.type||"VALIDATE_XML_WARNING"===e.type})))&&void 0!==e?e:[]},le=function(){var e,t;return null!==(e=null===(t=X.results)||void 0===t?void 0:t.filter((function(e){return"TRANSFORM_ERROR"===e.type||"VALIDATE_XML_ERROR"===e.type})))&&void 0!==e?e:[]};return Object(x.jsxs)(p.b,{children:[Object(x.jsxs)(p.a,{children:[Object(x.jsx)(p.g,{children:f("Produce XML dataset")}),Object(x.jsxs)(p.d,{children:[S&&"loading"in S&&"transform"===S.loading&&"\ud83d\udfe1 ".concat(f("Transforming XLS to XML...")),S&&"loading"in S&&"validateXml"===S.loading&&"\ud83d\udfe1 ".concat(f("Validating...")),S&&"error"in S&&"\ud83d\udd34 ".concat(f("Errors in validation"),": ").concat(S.error)]}),(null===(c=e.job)||void 0===c||null===(r=c.transform)||void 0===r?void 0:r.truncatedDueToPlanLimit)&&Object(x.jsxs)(p.d,{children:[Object(x.jsxs)(h.a,{align:"center",className:g.danger,children:[f("Warning"),": ",f("The produced dataset has been truncated to {{cigs}} CIGs; you can proceed and downoad it, but file is not to be published",{cigs:null===C||void 0===C||null===(d=C.plan)||void 0===d?void 0:d.cigNumberAllowed}),"."]}),Object(x.jsx)("br",{})]}),(null===(u=e.job)||void 0===u||null===(b=u.transform)||void 0===b?void 0:b.outputFile)&&Object(x.jsx)(A.a,{container:!0,sx:{overflowY:"auto",maxHeight:"300"},spacing:0,direction:"column",alignItems:"center",justify:"center",children:Object(x.jsx)(A.a,{item:!0,children:Object(x.jsx)(te.a,{sx:{backgroundColor:"#eee"},children:Object(x.jsx)(oe.a,{children:Object.keys(D).map((function(e,t){return Object(x.jsxs)(h.a,{sx:{fontSize:".8em"},color:"text.secondary",children:[e,": ",D[e]]},t)}))})})})}),(null===(j=e.job)||void 0===j||null===(v=j.transform)||void 0===v?void 0:v.outputFile)&&0===le().length&&0===ie().length&&Object(x.jsxs)(h.a,{children:["\ud83d\udfe2 ",f("Validation completed successfully")]}),le().length>0&&Object(x.jsx)("div",{style:{color:"darkred"},children:Object(x.jsx)(p.d,{children:Object(x.jsxs)(Z.a,{disableGutters:!0,classes:{root:g.accordionRoot},style:{color:"darkred"},children:[Object(x.jsx)(Q.a,{expandIcon:Object(x.jsx)(ae.a,{}),"aria-controls":"panel-error-content",id:"panel-error-header",children:Object(x.jsxs)(h.a,{children:["\ud83d\udd34 ","".concat(le().length," ").concat(f("errors"))]})}),Object(x.jsx)(ee.a,{children:Object(x.jsx)(h.a,{children:le().map((function(e,t){return Object(x.jsxs)("div",{style:{borderTop:"1px solid #ddd",paddingTop:5},children:[1+t,") ",e.type,": ",e.content]},t)}))})})]})})}),ie().length>0&&Object(x.jsx)("div",{style:{color:"darkorange"},children:Object(x.jsx)(p.d,{children:Object(x.jsxs)(Z.a,{disableGutters:!0,classes:{root:g.accordionRoot},style:{color:"orange"},children:[Object(x.jsx)(Q.a,{expandIcon:Object(x.jsx)(ae.a,{}),"aria-controls":"panel-warning-content",id:"panel-warning-header",children:Object(x.jsxs)(h.a,{children:["\ud83d\udfe0 ","".concat(ie().length," ").concat(f("warnings"))]})}),Object(x.jsx)(ee.a,{children:Object(x.jsx)(h.a,{children:ie().map((function(e,t){return Object(x.jsxs)("div",{style:{borderTop:"1px solid #ddd",paddingTop:5},children:[1+t,") ",e.type,": ",e.content]},t)}))})})]})})})]}),Object(x.jsxs)(A.a,{container:!0,className:g.root,children:[Object(x.jsx)(A.a,{item:!0,xs:6,children:Object(x.jsx)(p.e,{onPrev:function(){e.goto("prev")},prevIsEnabled:Y,children:f("Back")})}),Object(x.jsx)(A.a,{item:!0,xs:6,children:Object(x.jsx)(p.c,{onNext:function(){e.goto("next")},nextIsEnabled:B,children:f("Continue")})})]})]})}ie.defaultProps={};var le=a.a.memo(ie),re=Object(c.a)((function(e){return{danger:{color:e.palette.error.dark,fontWeight:"bold"}}}));function se(e){var t,o,a,c,r,d=Object(s.a)().t,u=re(),b=Object(w.f)(),j=O.a.getUser(),v=Object(n.useState)(!0),f=Object(i.a)(v,1)[0],m=Object(n.useState)((function(){var t,o,n;return!(null===(t=e.job)||void 0===t||!t.downloadDataset||null!==(o=e.job)&&void 0!==o&&null!==(n=o.transform)&&void 0!==n&&n.truncatedDueToPlanLimit)})),g=Object(i.a)(m,2),y=g[0],E=g[1],P=Object(I.b)().showModal,R=function(){return!!k.a.getCurrentUser()||(function(e){P(T.a,e)}({title:d("Please log in or register"),contentText:d("You need to be authenticated to proceed"),actions:[{text:d("Login"),closeModal:!0,autoFocus:!0,callback:function(){O.a.set("redirect",e.tabId),b.push("/signin")}},{text:d("Register"),closeModal:!0,callback:function(){O.a.set("redirect",e.tabId),b.push("/signup")}},{text:d("Cancel"),closeModal:!0,callback:function(){return e.goto("prev")}}]}),!1)};return Object(x.jsxs)(p.b,{children:[Object(x.jsxs)(p.a,{children:[Object(x.jsx)(p.g,{children:d("Download produced dataset")}),(null===(t=e.job)||void 0===t||null===(o=t.transform)||void 0===o?void 0:o.truncatedDueToPlanLimit)&&Object(x.jsxs)(p.d,{children:[Object(x.jsxs)(h.a,{align:"center",className:u.danger,children:[d("Warning"),": ",d("The produced dataset has been truncated to {{cigs}} CIGs; you can proceed and downoad it, but file is not to be published",{cigs:null===j||void 0===j||null===(a=j.plan)||void 0===a?void 0:a.cigNumberAllowed}),"."]}),Object(x.jsx)("br",{})]}),(null===(c=e.job)||void 0===c||null===(r=c.transform)||void 0===r?void 0:r.outputFile)&&Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)(p.d,{children:[d("Download dataset"),"."]}),Object(x.jsx)(p.d,{children:Object(x.jsxs)(C.a,{onClick:function(){if(R()){var t,o,n=e.job.transform.outputUrl;console.log("job:",e.job),console.log("url:",n),Object(S.e)(n),E(!(null!==(t=e.job)&&void 0!==t&&null!==(o=t.transform)&&void 0!==o&&o.truncatedDueToPlanLimit)),e.setJob(Object(l.a)(Object(l.a)({},e.job),{},{downloadDataset:!0}))}},variant:"contained",color:"tertiary",children:[d("Download")," \u2935"]})})]})]}),Object(x.jsxs)(A.a,{container:!0,children:[Object(x.jsx)(A.a,{item:!0,xs:6,children:Object(x.jsx)(p.e,{onPrev:function(){e.goto("prev")},prevIsEnabled:f,children:d("Back")})}),Object(x.jsx)(A.a,{item:!0,xs:6,children:Object(x.jsx)(p.c,{onNext:function(){e.goto("next")},nextIsEnabled:y,children:d("Continue")})})]})]})}se.defaultProps={};var de=a.a.memo(se);function ue(e){var t,o,a,c,r,d,u,b=Object(s.a)().t,j=Object(n.useState)({}),v=Object(i.a)(j,2),h=v[0],f=v[1],O=Object(n.useState)(!0),g=Object(i.a)(O,1)[0],y=Object(n.useState)((function(){var t;return void 0!==(null===(t=e.job)||void 0===t?void 0:t.downloadDataset)&&e.job.downloadDataset})),w=Object(i.a)(y,2),I=w[0],k=w[1],T=Object(n.useState)(!1),E=Object(i.a)(T,2),P=E[0],R=E[1],N=null===(t=e.job)||void 0===t||null===(o=t.transform)||void 0===o||null===(a=o.metadati)||void 0===a?void 0:a.urlFile,U=null===(c=e.job)||void 0===c||null===(r=c.transform)||void 0===r?void 0:r.outputFile;function D(){return(D=Object(L.a)(z.a.mark((function e(){return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:R(!0);case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(n.useEffect)((function(){var t;e.job&&e.job.transform&&(null!==(t=e.job)&&void 0!==t&&t.datasetIsPublished&&!P||Object(L.a)(z.a.mark((function t(){return z.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return f({loading:!0}),R(!1),t.next=4,m.a.urlExistenceAndMatch(N,U).then((function(t){var o,n;if(t instanceof Error)return J.b.error(Object(S.g)(t)),f({loading:!1,error:Object(S.g)(t)});e.setJob(Object(l.a)(Object(l.a)({},e.job),{},{datasetIsPublished:t.data.published,datasetIsPublishedAsIs:t.data.publishedAsIs})),f({loading:!1,success:!0}),console.log("+++ result?.data:",null===t||void 0===t?void 0:t.data),k((null===t||void 0===t||null===(o=t.data)||void 0===o?void 0:o.published)&&(null===t||void 0===t||null===(n=t.data)||void 0===n?void 0:n.publishedAsIs))}),(function(t){return J.b.error(Object(S.g)(t)),e.setJob(Object(l.a)(Object(l.a)({},e.job),{},{outcome:t.response.data.message})),f({error:Object(S.g)(t)})}));case 4:case"end":return t.stop()}}),t)})))())}),[e.job.transform,e.job.outcome,P]),Object(x.jsxs)(p.b,{children:[Object(x.jsxs)(p.a,{children:[Object(x.jsx)(p.g,{children:b("Publish downloaded dataset")}),(null===(d=e.job)||void 0===d||null===(u=d.transform)||void 0===u?void 0:u.outputFile)&&Object(x.jsxs)(x.Fragment,{children:[Object(x.jsxs)(p.d,{children:[h.loading&&"".concat(b("Checking"),"..."),!h.loading&&!e.job.datasetIsPublished&&"\ud83d\udd34 ".concat(b("Dataset is not published yet at address {{publishUrlFile}}",{publishUrlFile:N})),!h.loading&&e.job.datasetIsPublished&&!e.job.datasetIsPublishedAsIs&&"\ud83d\udd34 ".concat(b("Dataset is published at address {{publishUrlFile}}, but differs from produced dataset",{publishUrlFile:N})),!h.loading&&e.job.datasetIsPublished&&e.job.datasetIsPublishedAsIs&&"\ud83d\udfe2 ".concat(b("Dataset is correctly published at address {{publishUrlFile}}",{publishUrlFile:N}))]}),Object(x.jsx)(p.d,{children:!h.loading&&Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("br",{}),Object(x.jsxs)(C.a,{onClick:function(){return D.apply(this,arguments)},variant:"contained",color:"tertiary",children:[b("Verify publication now")," \ud83c\udf0d"]})]})})]})]}),Object(x.jsxs)(A.a,{container:!0,children:[Object(x.jsx)(A.a,{item:!0,xs:6,children:Object(x.jsx)(p.e,{onPrev:function(){e.goto("prev")},prevIsEnabled:g,children:b("Back")})}),Object(x.jsx)(A.a,{item:!0,xs:6,children:Object(x.jsx)(p.c,{onNext:function(){e.goto("next")},nextIsEnabled:I,children:b("Continue")})})]})]})}ue.defaultProps={};var be=a.a.memo(ue);function je(e){var t,o,a,c,r,d,u,b,j,v,h,f,O,g,y,w,I,k,T,E,P,R,N,U,D,F,M,X,G,W,_,B,q,V,Y,H,K,$,Z,Q,ee,te,oe,ne,ae,ce,ie,le,re,se,de,ue,be,je,ve,he,fe,Oe,me,pe,xe,ge,ye,we,Ie,Ae,Ce,ke,Te,Ee,Pe,Se,Re,Ne,Ue,De,Fe=Object(s.a)().t,Le=Object(n.useState)({}),Me=Object(i.a)(Le,2),ze=Me[0],Je=Me[1],Xe=Object(n.useState)(!1),Ge=Object(i.a)(Xe,2),We=Ge[0],_e=Ge[1],Be=Object(n.useState)(!0),qe=Object(i.a)(Be,1)[0],Ve=Object(n.useState)(!(null!==(t=e.job)&&void 0!==t&&null!==(o=t.outcome)&&void 0!==o&&o.esitoUltimoTentativoAccessoUrl)),Ye=Object(i.a)(Ve,2),He=Ye[0],Ke=Ye[1];function $e(){return($e=Object(L.a)(z.a.mark((function e(){return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Ke(!0);case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Object(n.useEffect)((function(){var t;if(null!==(t=e.job)&&void 0!==t&&t.transform){var o,n,a,c;if(null!==(o=e.job)&&void 0!==o&&null!==(n=o.outcome)&&void 0!==n&&n.esitoUltimoTentativoAccessoUrl)_e("successo"===(null===(a=e.job)||void 0===a||null===(c=a.outcome)||void 0===c?void 0:c.esitoUltimoTentativoAccessoUrl)),Je({});He&&Object(L.a)(z.a.mark((function t(){var o,n,a,c,i,r;return z.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Je({loading:!0}),t.next=3,m.a.outcomeCheck(null===(o=e.job)||void 0===o||null===(n=o.transform)||void 0===n||null===(a=n.metadati)||void 0===a?void 0:a.annoRiferimento,null===(c=e.job)||void 0===c||null===(i=c.transform)||void 0===i||null===(r=i.header)||void 0===r?void 0:r.codiceFiscaleStrutturaProponente).then((function(t){var o,n;if(Ke(!1),t instanceof Error)return J.b.error(Object(S.g)(t)),Je({error:Object(S.g)(t)});console.log("OUTCOMECHECK result:",t.data.result),e.setJob(Object(l.a)(Object(l.a)({},e.job),{},{outcome:t.data.result})),Je({}),_e("successo"===(null===(o=e.job)||void 0===o||null===(n=o.outcome)||void 0===n?void 0:n.esitoUltimoTentativoAccessoUrl))}),(function(t){return J.b.error(Object(S.g)(t)),e.setJob(Object(l.a)(Object(l.a)({},e.job),{},{outcome:t.response.data.message})),Je({error:Object(S.g)(t)})}));case 3:case"end":return t.stop()}}),t)})))()}}),[e.job.transform,He]);console.log("statusLocal:",ze),console.log("props.job?.outcome:",null===(a=e.job)||void 0===a?void 0:a.outcome);var Ze=(null===(c=e.job)||void 0===c||null===(r=c.outcome)||void 0===r||null===(d=r.tentativiAccessoUrl)||void 0===d?void 0:d.length)-1,Qe=Ze>=0?(null===(u=e.job)||void 0===u||null===(b=u.outcome)||void 0===b||null===(j=b.tentativiAccessoUrl[Ze])||void 0===j||null===(v=j.listaAccessoRisorsa)||void 0===v?void 0:v.length)-1:-1;return Object(x.jsxs)(p.b,{children:[Object(x.jsxs)(p.a,{children:[Object(x.jsx)(p.g,{children:Fe("Check ANAC validation")}),Object(x.jsxs)(p.d,{children:[ze&&"loading"in ze&&"".concat(Fe("Checking"),"..."),ze&&!("loading"in ze)&&"in corso"===(null===(h=e.job)||void 0===h||null===(f=h.outcome)||void 0===f?void 0:f.esitoUltimoTentativoAccessoUrl)&&"\ud83d\udfe1 ".concat(Fe("attempt in progress"),"..."),ze&&!("loading"in ze)&&"successo"===(null===(O=e.job)||void 0===O||null===(g=O.outcome)||void 0===g?void 0:g.esitoUltimoTentativoAccessoUrl)&&"\ud83d\udfe2 ".concat(Fe("last attempt succeeded")),ze&&!("loading"in ze)&&"fallito"===(null===(y=e.job)||void 0===y||null===(w=y.outcome)||void 0===w?void 0:w.esitoUltimoTentativoAccessoUrl)&&"\ud83d\udd34 ".concat(Fe("last attempt failed"))]}),ze&&!("loading"in ze)&&Object(x.jsx)("div",{style:{fontSize:"0.8em",marginLeft:"3em"},children:Object(x.jsxs)(p.d,{children:[Object(x.jsxs)("i",{children:[Fe("last verification date"),":"]})," ",null!==(I=e.job)&&void 0!==I&&null!==(k=I.outcome)&&void 0!==k&&k.dataUltimoTentativoAccessoUrl?Object(S.c)(null===(T=e.job)||void 0===T||null===(E=T.outcome)||void 0===E?void 0:E.dataUltimoTentativoAccessoUrl):Fe("never")]})}),ze&&!("loading"in ze)&&"fallito"===(null===(P=e.job)||void 0===P||null===(R=P.outcome)||void 0===R?void 0:R.esitoUltimoTentativoAccessoUrl)&&Object(x.jsxs)("div",{style:{fontSize:"0.8em",marginLeft:"3em"},children:[Object(x.jsxs)(p.d,{children:[Object(x.jsxs)("i",{children:[Fe("outcome code"),":"]})," ",null!==(N=null===(U=e.job)||void 0===U||null===(D=U.outcome)||void 0===D||null===(F=D.esitoComunicazione)||void 0===F?void 0:F.codice)&&void 0!==N?N:"?"]}),Object(x.jsxs)(p.d,{children:[Object(x.jsxs)("i",{children:[Fe("outcome description"),":"]})," ",null!==(M=null===(X=e.job)||void 0===X||null===(G=X.outcome)||void 0===G||null===(W=G.esitoComunicazione)||void 0===W?void 0:W.descrizione)&&void 0!==M?M:"?"]}),Object(x.jsxs)(p.d,{children:[Object(x.jsxs)("i",{children:[Fe("outcome detail"),":"]})," ",null!==(_=null===(B=e.job)||void 0===B||null===(q=B.outcome)||void 0===q||null===(V=q.esitoComunicazione)||void 0===V?void 0:V.dettaglio)&&void 0!==_?_:"?"]})]}),ze&&!("loading"in ze)&&"fallito"===(null===(Y=e.job)||void 0===Y||null===(H=Y.outcome)||void 0===H?void 0:H.esitoUltimoTentativoAccessoUrl)&&Ze>=0&&Object(x.jsxs)("div",{style:{fontSize:"0.8em",marginLeft:"3em"},children:[Object(x.jsxs)(p.d,{children:[Object(x.jsxs)("i",{children:[Fe("last attempt to access url outcome code"),":"]})," ",null!==(K=null===($=e.job)||void 0===$||null===(Z=$.outcome)||void 0===Z||null===(Q=Z.tentativiAccessoUrl[Ze])||void 0===Q||null===(ee=Q.esito)||void 0===ee?void 0:ee.codice)&&void 0!==K?K:"?"]}),Object(x.jsxs)(p.d,{children:[Object(x.jsxs)("i",{children:[Fe("last attempt to access url outcome description"),":"]})," ",null!==(te=null===(oe=e.job)||void 0===oe||null===(ne=oe.outcome)||void 0===ne||null===(ae=ne.tentativiAccessoUrl[Ze])||void 0===ae||null===(ce=ae.esito)||void 0===ce?void 0:ce.descrizione)&&void 0!==te?te:"?"]})]}),ze&&!("loading"in ze)&&"fallito"===(null===(ie=e.job)||void 0===ie||null===(le=ie.outcome)||void 0===le?void 0:le.esitoUltimoTentativoAccessoUrl)&&Ze>=0&&Qe>=0&&Object(x.jsxs)("div",{style:{fontSize:"0.8em",marginLeft:"3em"},children:[Object(x.jsxs)(p.d,{children:[Object(x.jsxs)("i",{children:[Fe("last attempt to access resource"),":"]})," ",null!==(re=null===(se=e.job)||void 0===se||null===(de=se.outcome)||void 0===de||null===(ue=de.tentativiAccessoUrl[Ze])||void 0===ue||null===(be=ue.listaAccessoRisorsa[Qe])||void 0===be?void 0:be.url)&&void 0!==re?re:"?"]}),Object(x.jsxs)(p.d,{children:[Object(x.jsxs)("i",{children:[Fe("last attempt to access resource xml valid"),":"]})," ",null!==(je=e.job)&&void 0!==je&&null!==(ve=je.outcome)&&void 0!==ve&&null!==(he=ve.tentativiAccessoUrl[Ze])&&void 0!==he&&null!==(fe=he.listaAccessoRisorsa[Qe])&&void 0!==fe&&fe.xmlValido?Fe("yes"):Fe("no")]}),Object(x.jsxs)(p.d,{children:[Object(x.jsxs)("i",{children:[Fe("last attempt to access resource xml validation"),":"]})," ",null!==(Oe=null===(me=e.job)||void 0===me||null===(pe=me.outcome)||void 0===pe||null===(xe=pe.tentativiAccessoUrl[Ze])||void 0===xe||null===(ge=xe.listaAccessoRisorsa[Qe])||void 0===ge?void 0:ge.dettaglioValidazioneXml)&&void 0!==Oe?Oe:Fe("(empty)")]}),Object(x.jsxs)(p.d,{children:[Object(x.jsxs)("i",{children:[Fe("last attempt to access resource code"),":"]})," ",null!==(ye=null===(we=e.job)||void 0===we||null===(Ie=we.outcome)||void 0===Ie||null===(Ae=Ie.tentativiAccessoUrl[Ze])||void 0===Ae||null===(Ce=Ae.listaAccessoRisorsa[Qe])||void 0===Ce||null===(ke=Ce.esitoAccessoRisorsa)||void 0===ke?void 0:ke.codice)&&void 0!==ye?ye:"?"]}),Object(x.jsxs)(p.d,{children:[Object(x.jsxs)("i",{children:[Fe("last attempt to access resource description"),":"]})," ",null!==(Te=null===(Ee=e.job)||void 0===Ee||null===(Pe=Ee.outcome)||void 0===Pe||null===(Se=Pe.tentativiAccessoUrl[Ze])||void 0===Se||null===(Re=Se.listaAccessoRisorsa[Qe])||void 0===Re||null===(Ne=Re.esitoAccessoRisorsa)||void 0===Ne?void 0:Ne.descrizione)&&void 0!==Te?Te:"?"]})]}),Object(x.jsx)("br",{}),Object(x.jsx)(p.d,{children:e.job.datasetIsPublished&&!("successo"===(null===(Ue=e.job)||void 0===Ue||null===(De=Ue.outcome)||void 0===De?void 0:De.esitoUltimoTentativoAccessoUrl))&&Object(x.jsxs)(C.a,{onClick:function(){return $e.apply(this,arguments)},variant:"contained",color:"tertiary",children:[Fe("Check validation now")," \ud83c\udfaf"]})})]}),Object(x.jsxs)(A.a,{container:!0,children:[Object(x.jsx)(A.a,{item:!0,xs:6,children:Object(x.jsx)(p.e,{onPrev:function(){e.goto("prev")},prevIsEnabled:qe,children:Fe("Back")})}),Object(x.jsx)(A.a,{item:!0,xs:6,children:Object(x.jsx)(p.c,{onNext:function(){e.goto("next")},nextIsEnabled:We,children:Fe("Continue")})})]})]})}je.defaultProps={};var ve=a.a.memo(je);function he(e){var t,o,a,c,l,r=Object(s.a)().t,d=Object(n.useState)(!0),u=Object(i.a)(d,1)[0];return Object(x.jsxs)(p.b,{children:[Object(x.jsxs)(p.a,{children:[Object(x.jsxs)(p.g,{children:[r("Finished"),"!"]}),(null===(t=e.job)||void 0===t||null===(o=t.transform)||void 0===o?void 0:o.outputFile)&&Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(p.d,{children:Object(x.jsx)("div",{style:{fontSize:128,textAlign:"center"},children:"\ud83c\udfc1"})}),Object(x.jsx)(p.d,{children:Object(x.jsx)("div",{style:{textAlign:"center"},children:r("Compliments, you did comply successfully to {{appTitle}} fulfillments for year {{year}}",{appTitle:P.a.appTitle,year:null===(a=e.job)||void 0===a||null===(c=a.transform)||void 0===c||null===(l=c.metadati)||void 0===l?void 0:l.annoRiferimento})})})]})]}),Object(x.jsx)(A.a,{container:!0,children:Object(x.jsx)(A.a,{item:!0,xs:6,children:Object(x.jsx)(p.e,{onPrev:function(){e.goto("prev")},prevIsEnabled:u,children:r("Back")})})})]})}he.defaultProps={};var fe=a.a.memo(he),Oe=["children","value","index"];function me(e){var t=e.children,o=e.value,n=e.index,a=Object(r.a)(e,Oe);return Object(x.jsx)(h.a,Object(l.a)(Object(l.a)({component:"div",role:"tabpanel",hidden:o!==n,id:"scrollable-auto-tabpanel-".concat(n),"aria-labelledby":"nav-tab-".concat(n)},a),{},{children:Object(x.jsx)(f.a,{p:3,children:t})}))}var pe=function(e){return{id:"nav-tab-".concat(e),"aria-controls":"nav-tabpanel-".concat(e)}},xe=Object(d.a)((function(e){return{root:{opacity:.8}}}))((function(e){return Object(x.jsx)(v.a,Object(l.a)({},e))})),ge=Object(c.a)((function(e){return{root:{flexGrow:1},tab:{backgroundColor:e.palette.secondary.light},tabIndicator:{backgroundColor:"MediumSeaGreen",height:3}}})),ye=function(){var e=ge(),t=Object(n.useState)((function(){return O.a.getJob()})),o=Object(i.a)(t,2),a=o[0],c=o[1],r=Object(s.a)().t;function d(e){c(Object(l.a)(Object(l.a)({},a),{},{tabId:e}))}function v(e){var t=e;if("string"===typeof e)switch(e.toLowerCase()){case"start":case"download template":case"fill your data":case"upload":case"produce":case"download dataset":case"publish":case"wait for validation":case"finish!":break;case"next":t=a?a.tabId+1:0;break;case"prev":t=a?a.tabId-1:0;break;default:return void console.error("Unforeseen where specification in goto: ".concat(e))}d(t)}return Object(n.useEffect)((function(){var e=O.a.get("redirect");e&&(c(Object(l.a)(Object(l.a)({},a),{},{tabId:e})),O.a.remove("redirect"))}),[a]),Object(n.useEffect)((function(){O.a.setJob(a),m.a.set(a)}),[a]),null!==a&&void 0!==a&&a.tabId||(a.tabId=0),Object(x.jsxs)("div",{className:e.root,children:[Object(x.jsx)(u.a,{elevation:0,position:"fixed",style:{top:50},children:Object(x.jsx)(b.a,{elevation:1,square:!0,children:Object(x.jsxs)(j.a,{value:null===a||void 0===a?void 0:a.tabId,variant:"scrollable",scrollButtons:"auto",onChange:function(e,t){P.a.ui.userCanForceTabChange&&d(t)},"aria-label":"current section",classes:{indicator:e.tabIndicator},className:e.tab,children:[Object(x.jsx)(xe,Object(l.a)({label:"".concat(r("Start")," \ud83e\ude84")},pe(0))),Object(x.jsx)(xe,Object(l.a)({label:"".concat(r("Download template")," \u25bc")},pe(1))),Object(x.jsx)(xe,Object(l.a)({label:"".concat(r("Fill your data")," \ud83d\udd8b")},pe(2))),Object(x.jsx)(xe,Object(l.a)({label:"".concat(r("Upload")," \u25b2")},pe(3))),Object(x.jsx)(xe,Object(l.a)({label:"".concat(r("Produce")," \ud83d\udee0\ufe0f")},pe(4))),Object(x.jsx)(xe,Object(l.a)({label:"".concat(r("Download dataset")," \u2935")},pe(5))),Object(x.jsx)(xe,Object(l.a)({label:"".concat(r("Publish")," \ud83c\udf0d")},pe(6))),Object(x.jsx)(xe,Object(l.a)({label:"".concat(r("Wait for validation")," \ud83c\udfaf")},pe(7))),Object(x.jsx)(xe,Object(l.a)({label:"".concat(r("Finish!")," \ud83c\udfc1")},pe(8)))]})})}),Object(x.jsxs)(x.Fragment,{children:[0===(null===a||void 0===a?void 0:a.tabId)&&Object(x.jsx)(me,{index:0,value:a.tabId,children:Object(x.jsx)(y,{goto:v,job:a,setJob:function(e){return c(e)}})}),1===(null===a||void 0===a?void 0:a.tabId)&&Object(x.jsx)(me,{index:1,value:a.tabId,children:Object(x.jsx)(N,{goto:v,job:a,setJob:function(e){return c(e)}})}),2===(null===a||void 0===a?void 0:a.tabId)&&Object(x.jsx)(me,{index:2,value:a.tabId,children:Object(x.jsx)(F,{goto:v,job:a,setJob:function(e){return c(e)}})}),3===(null===a||void 0===a?void 0:a.tabId)&&Object(x.jsx)(me,{index:3,value:a.tabId,children:Object(x.jsx)($,{goto:v,job:a,setJob:function(e){return c(e)}})}),4===(null===a||void 0===a?void 0:a.tabId)&&Object(x.jsx)(me,{index:4,value:a.tabId,children:Object(x.jsx)(le,{goto:v,job:a,setJob:function(e){return c(e)}})}),5===(null===a||void 0===a?void 0:a.tabId)&&Object(x.jsx)(me,{index:5,value:a.tabId,children:Object(x.jsx)(de,{goto:v,job:a,setJob:function(e){return c(e)}})}),6===(null===a||void 0===a?void 0:a.tabId)&&Object(x.jsx)(me,{index:6,value:a.tabId,children:Object(x.jsx)(be,{goto:v,job:a,setJob:function(e){return c(e)}})}),7===(null===a||void 0===a?void 0:a.tabId)&&Object(x.jsx)(me,{index:7,value:a.tabId,children:Object(x.jsx)(ve,{goto:v,job:a,setJob:function(e){return c(e)}})}),8===(null===a||void 0===a?void 0:a.tabId)&&Object(x.jsx)(me,{index:8,value:a.tabId,children:Object(x.jsx)(fe,{goto:v,job:a,setJob:function(e){return c(e)}})})]})]})},we=Object(c.a)((function(e){return{home:{fontSize:"1.5em"}}}));function Ie(){var e=we();return Object(x.jsx)("div",{className:e.home,children:Object(x.jsx)(ye,{})})}t.default=a.a.memo(Ie)}}]);
//# sourceMappingURL=16.af414b54.chunk.js.map