(this["webpackJsonpappalti190-client"]=this["webpackJsonpappalti190-client"]||[]).push([[12],{234:function(e,t,n){"use strict";n.d(t,"c",(function(){return m})),n.d(t,"a",(function(){return h})),n.d(t,"e",(function(){return x})),n.d(t,"d",(function(){return v})),n.d(t,"b",(function(){return g}));var a=n(17),o=n(0),c=n.n(o),r=n(224),i=n(312),l=n(303),s=n(317),d=n(217),u=n(179),b=n(182),j=n(302),p=function(e,t){return"#"+e.replace(/^#/,"").replace(/../g,(function(e){return("0"+Math.min(255,Math.max(0,parseInt(e,16)+t)).toString(16)).substr(-2)}))},f=n(55),O=n(2),m=c.a.memo((function(e){var t=Object(b.a)((function(e){return{startAdornment:{backgroundColor:"#eaedf0",height:"2.5rem",maxHeight:"3rem",marginLeft:-15,marginRight:5,paddingLeft:10,paddingRight:10,borderRight:"1px solid #c5c5c5"},endAdornment:{backgroundColor:"#eaedf0",height:"2.5rem",maxHeight:"3rem",marginLeft:5,marginRight:-15,paddingLeft:10,paddingRight:10,borderLeft:"1px solid #c5c5c5"}}}))();return Object(O.jsx)(i.a,{id:e.id,type:e.type,value:e.value,required:e.required,autoFocus:e.autoFocus,autoComplete:e.autoComplete.toString(),variant:e.variant,fullWidth:e.fullWidth,label:e.label,size:e.size,margin:e.margin,className:e.className?e.className:t.textField,placeholder:e.placeholder,onChange:function(t){return e.onChange(t.target.value)},disabled:e.disabled,error:!Object(f.e)(e.error),InputProps:{startAdornment:e.startAdornmentIcon?Object(O.jsx)(j.a,{className:e.startAdornmentClass?e.startAdornmentClass:t.startAdornment,position:"start",children:e.startAdornmentIcon}):Object(O.jsx)(O.Fragment,{}),endAdornment:e.endAdornmentIcon?Object(O.jsx)(j.a,{className:e.endAdornmentClass?e.endAdornmentClass:t.endAdornment,position:"end",children:e.endAdornmentIcon}):Object(O.jsx)(O.Fragment,{}),className:t.input}})}));m.defaultProps={type:"text",required:!1,autoFocus:!1,autoComplete:!1,variant:"outlined",fullWidth:!0,label:"",size:"small",margin:"dense",className:null,placeholder:"",startAdornmentClass:null,endAdornmentClass:null,disabled:!1,error:""};var h=c.a.memo((function(e){var t=Object(b.a)((function(e){return function(e){return{button:{margin:e.spacing(1,0,0,0),textTransform:"none",fontSize:"1.3em",color:"white",backgroundColor:e.palette.success.main,"&:hover":{backgroundColor:p(e.palette.success.main,-25)}},buttonSecondary:{margin:e.spacing(1,0,0,0),textTransform:"none",fontSize:"1em !important",color:"white",backgroundColor:e.palette.secondary.dark+" !important","&:hover":{backgroundColor:p(e.palette.secondary.dark,-25)+" !important"}},buttonFederated:{margin:e.spacing(1,0,0,0),justifyContent:"flex-start",paddingLeft:e.spacing(5),fontSize:"1.3em"},buttonFederatedFacebook:{backgroundColor:e.palette.socialButtons.facebook.backgroundColor,"&:hover":{backgroundColor:p(e.palette.socialButtons.facebook.backgroundColor,-25)}},buttonFederatedGoogle:{backgroundColor:e.palette.socialButtons.google.backgroundColor,"&:hover":{backgroundColor:p(e.palette.socialButtons.google.backgroundColor,-25)}}}}(e)}))();return Object(O.jsx)(r.a,{fullWidth:e.fullWidth,variant:e.variant,color:e.color,size:e.size,className:"".concat(t.button," ").concat(e.social?t.buttonFederated:""," ").concat(e.social?t["buttonFederated"+Object(f.a)(e.social)]:""," ").concat(t[e.className]),startIcon:e.startIcon,onClick:e.onClick,disabled:e.disabled,children:e.children})}));h.defaultProps={fullWidth:!0,variant:"contained",color:"primary",social:null},c.a.memo((function(e){var t=Object(b.a)((function(e){return{disabled:{color:"grey",cursor:"default","&:hover":{textDecoration:"none"}}}}))(),n=e.disabled?t.disabled:"";return Object(O.jsx)(l.a,{control:Object(O.jsx)(s.a,{checked:e.checked,onChange:function(t){return e.onChange(t.target.checked)},className:"".concat(e.className," ").concat(n),color:e.color,size:e.size,disabled:e.disabled}),label:Object(O.jsx)(x,{className:"".concat(e.className," ").concat(n),children:e.children})})})).defaultProps={checked:!1,color:"primary",size:"small"};var x=c.a.memo((function(e){return Object(O.jsx)(u.a,Object(a.a)(Object(a.a)({component:e.component,variant:e.variant,color:e.color,align:e.align},e),{},{children:e.children}))}));x.defaultProps={component:"h1",variant:"body2",color:"textPrimary"};var v=c.a.memo((function(e){var t=Object(b.a)((function(t){return{normal:{cursor:"pointer",textDecoration:e.decoration?e.decoration:"none"},disabled:{color:"grey",cursor:"default","&:hover":{textDecoration:"none",color:"grey"}}}}))(),n=e.disabled?t.disabled:t.normal;return Object(O.jsx)(d.a,Object(a.a)(Object(a.a)({href:e.href,className:"".concat(e.className," ").concat(n),color:e.color},e),{},{children:e.children}))}));v.defaultProps={color:"textPrimary"};var g=c.a.memo((function(e){var t=Object(b.a)((function(t){return function(t){return{container:{display:"flex",alignItems:"center",marginTop:t.spacing(e.marginVertical),marginBottom:t.spacing(e.marginVertical)},divider:{width:"100%",borderBottom:"1px solid "+(e.color?e.color:t.palette.primary.dark),paddingLeft:t.spacing(1)},text:{paddingLeft:t.spacing(e.paddingHorizontal),paddingRight:t.spacing(e.paddingHorizontal)}}}(t)}))();return Object(O.jsxs)("div",{className:t.container,children:[Object(O.jsx)("div",{className:t.divider}),e.children&&Object(O.jsx)("span",{className:t.text,children:e.children}),Object(O.jsx)("div",{className:t.divider})]})}));g.defaultProps={marginVertical:1,paddingHorizontal:1}},235:function(e,t,n){"use strict";var a=n(0),o=n.n(a),c=n(179),r=n(263),i=n(266),l=n(265),s=n(264),d=n(234),u=n(2),b=function(e){return Object(u.jsxs)(r.a,{open:e.dialogOpen,onClose:function(){return e.dialogSetOpen(!1)},"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[Object(u.jsx)(s.a,{id:"alert-dialog-title",children:e.dialogTitle}),Object(u.jsx)(l.a,{id:"alert-dialog-description",children:Object(u.jsx)(c.a,{variant:"body1",style:{whiteSpace:"pre-line"},children:e.dialogContent})}),Object(u.jsx)(i.a,{children:e.dialogButtons.map((function(t,n){return Object(u.jsx)(d.a,{onClick:function(){t.callback&&t.callback(),t.close&&e.dialogSetOpen(!1)},fullWidth:!1,className:"buttonSecondary",autoFocus:0===n,children:t.text},n)}))})]})};b.defaultProps={dialogOpen:!1,dialogButtons:[{text:"Ok",close:!0,callback:function(){}}]},t.a=o.a.memo(b)},314:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),c=n(182),r=n(19),i=n(17),l=n(288),s=n(230),d=n(6),u=n(215),b=n(219),j=n(180),p=n(315),f=n(304),O=n(179),m=n(313),h=n(37),x=n(83),v=n(72),g=n.n(v),k=n(20),C=function(){var e=Object(x.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(h.a.getUser()){e.next=3;break}return e.abrupt("return",null);case 3:return e.next=5,k.a.get("/job/get");case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),S={get:C,set:function(e){return h.a.getUser()?k.a.put("/job/set",{job:e}):null},upload:function(e){var t=new FormData;return t.append("file",e),k.a.post("/job/upload",t,{headers:{"Content-Type":"multipart/form-data"}})},transformXls2Xml:function(e){return k.a.post("/job/transformXls2Xml/:filePath",{filePath:e})},validateXml:function(e){return k.a.post("/job/validateXml/:transform",{transform:e})},outcomeCheck:function(e,t){return k.a.post("/job/outcomeCheck/:anno/:codiceFiscaleAmministrazione",{anno:e,codiceFiscaleAmministrazione:t})},outcomeFailureDetails:function(e,t){return k.a.post("/job/outcomeFailureDetails/anno/codiceFiscaleAmministrazione",{anno:e,codiceFiscaleAmministrazione:t})},sanitizeJob:function(e){var t;if(null===e||void 0===e||null===(t=e.transform)||void 0===t||!t.xml)return e;var n=e;return n.transform.xml="\u2026",n}},I=n(224),y=n(320);var w=n(2),N=Object(c.a)((function(e){return{paragraph:{fontSize:"1.1em"},paragraphSmall:{fontSize:"0.8em"},centered:{display:"flex",justifyContent:"center",alignItems:"center"},justified:{textAlign:"justify"},box:{display:"flex"},boxLeft:{justifyContent:"flex-start"},boxRight:{justifyContent:"flex-end"},sup:{fontSize:"0.8em"},scrollableContainer:{display:"flex",flexDirection:"column",marginTop:"1em",minHeight:"5em"},scrollable:{height:"100%",overflowY:"auto",paddingLeft:10,paddingRight:10,minHeight:"3em"}}})),E=o.a.memo((function(e){return Object(w.jsx)("div",{children:e.children})}));E.defaultProps={};var P=o.a.memo((function(e){var t=N(),n=function(){var e=Object(a.useState)({width:window.innerWidth,height:window.innerHeight}),t=Object(r.a)(e,2),n=t[0],o=t[1];return Object(a.useEffect)((function(){function e(){o({width:window.innerWidth,height:window.innerHeight})}return window.addEventListener("resize",e),e(),function(){return window.removeEventListener("resize",e)}}),[]),n}();return Object(w.jsx)("div",{className:t.scrollableContainer,children:Object(w.jsx)("div",{className:t.scrollable,style:{height:Math.max(120,n.height-90-100-60)},children:e.children})})}));P.defaultProps={};var z=o.a.memo((function(e){var t=N();return Object(w.jsx)("div",{className:t.centered,children:Object(w.jsx)("h2",{children:e.children})})}));z.defaultProps={};var A=o.a.memo((function(e){var t=N();return Object(w.jsx)(m.a,{mb:1,children:Object(w.jsx)(O.a,{component:"div",className:"".concat(t.paragraph," ").concat(t.justified," ").concat(e.small?t.paragraphSmall:null," ").concat(e.class),children:e.children})})}));A.defaultProps={class:null};var D=o.a.memo((function(e){var t=N();return Object(w.jsx)(m.a,{component:"span",m:1,className:"".concat(t.box," ").concat(t.boxLeft),children:Object(w.jsx)(I.a,{variant:"contained",color:"secondary",onClick:e.onPrev,disabled:!e.prevIsEnabled,children:e.children})})}));D.defaultProps={};var J=o.a.memo((function(e){var t=N();return Object(w.jsx)(m.a,{component:"span",m:1,className:"".concat(t.box," ").concat(t.boxRight),children:Object(w.jsx)(I.a,{variant:"contained",color:"secondary",onClick:e.onNext,disabled:!e.nextIsEnabled,children:e.children})})}));J.defaultProps={};var T=o.a.memo((function(e){var t=N();return Object(w.jsx)(y.a,{title:e.title,placement:"top",children:Object(w.jsx)("sup",{className:t.sup,children:e.anchor})})}));function F(e){var t=Object(s.a)().t,n=Object(a.useState)(!0),o=Object(r.a)(n,1)[0];return Object(w.jsxs)(E,{children:[Object(w.jsxs)(P,{children:[Object(w.jsx)(z,{children:t("Welcome!")}),Object(w.jsxs)(A,{children:["Questa \xe8 la nostra proposta per adempiere i requisiti della "," ",Object(w.jsx)("a",{href:"https://www.anticorruzione.it/-/adempimenti-legge-190/2012-art.-1-comma-32-7",target:"legge190",children:"Legge 190"}),". Speriamo che sia chiara e semplice da usare."]}),Object(w.jsx)(A,{children:"Questa app ti guider\xe0 passo passo nei pochi steps che occorrono per completare l'adempimento con successo."}),Object(w.jsxs)(A,{children:["Per iniziare dovrai scaricare un modello Excel",Object(w.jsx)(T,{title:"Pu\xf2 essere in formato MicroSoft-Excel, oppure in formato ODS, come preferisci."}),", che contiene delle regole per guidarti nella compilazione, e minimizzare i possibili errori formali."]}),Object(w.jsx)(A,{children:"Poi dovrai inserire, uno per riga, tutti i beni o servizi che la tua struttura ha appaltato nell'anno in corso."}),Object(w.jsx)(A,{children:"Alla fine dell'anno, in genere entro la fine di Gennaio dell'anno successivo, sar\xe0 sufficiente caricare qui il foglio Excel compilato."}),Object(w.jsx)(A,{children:"A questo punto il nostro sistema effettuer\xe0 il controllo formale dei dati inseriti. Nel caso che venga segnalato qualche anomalia dovrai correggere sul file Excel le anomalie segnalate, e poi ri-caricarlo."}),Object(w.jsx)(A,{children:"Dopodich\xe8 potrai scaricare il documento XML prodotto, che andr\xe0 pubblicato sul sito cui fa riferimento la tua struttura."}),Object(w.jsx)(A,{children:"A questo punto avrai praticamente completato l'adempimento. Se vorrai potrai controllare - sempre su questo sito - l'esito della verifica da parte dell'ANAC."}),Object(w.jsx)(A,{children:'Tieni presente che siamo sempre disponibili a risponderti per qualsiasi dubbio o incertezza. Le modalit\xe0 di assistenza sono diverse, dal supporto telefonico a quello per email, e dipendono anche dal piano scelto. I riferimenti sono presenti nel menu, alla voce "Supporto".'})]}),Object(w.jsx)("div",{children:Object(w.jsx)(J,{onNext:function(){e.goto("next")},nextIsEnabled:o,children:"".concat(t("Start"))})})]})}T.defaultProps={anchor:"*"},F.defaultProps={};var L=o.a.memo(F),R=n(11),U=n(218),B=n(57),q=n(235),X=n(12),W=n.n(X);function M(e){var t=Object(s.a)().t,n=Object(R.f)(),o=Object(a.useState)(!0),c=Object(r.a)(o,1)[0],l=Object(a.useState)((function(){var t,n;return!(null===(t=e.job)||void 0===t||!t.download)&&(null===(n=e.job)||void 0===n?void 0:n.download)})),d=Object(r.a)(l,2),u=d[0],b=d[1],j=Object(a.useState)(null),p=Object(r.a)(j,2),f=p[0],O=p[1],m=Object(a.useState)(null),x=Object(r.a)(m,2),v=x[0],g=x[1],k=Object(a.useState)([]),C=Object(r.a)(k,2),S=C[0],y=C[1],N=Object(a.useState)(!1),T=Object(r.a)(N,2),F=T[0],L=T[1],X=function(){return!!B.a.getCurrentUser()||(a=t("Please log in or register"),o=t("You need to be authenticated to proceed"),c=[{text:t("Login"),close:!0,callback:function(){h.a.set("redirect",e.tabId),n.push("/signin")}},{text:t("Register"),close:!0,callback:function(){return n.push("/signup")}},{text:t("Cancel"),close:!0}],O(a),g(o),y(c),L(!0),!1);var a,o,c};return Object(w.jsxs)(E,{children:[Object(w.jsxs)(P,{children:[Object(w.jsx)(z,{children:t("Download")}),Object(w.jsx)(A,{children:"Scarica il modello Excel in cui potrai inserire i dati degli appalti, uno per riga."}),Object(w.jsx)(A,{children:Object(w.jsxs)(I.a,{onClick:function(){if(X()){var t=document.createElement("a");t.download=W.a.data.templateDownloadName,t.href=W.a.data.templateDownloadLink,t.click(),b(!0),e.setJob(Object(i.a)(Object(i.a)({},e.job),{},{download:!0}))}},variant:"contained",color:"primary",children:[t("Download")," \u2b07"]})})]}),Object(w.jsxs)(U.a,{container:!0,children:[Object(w.jsx)(U.a,{item:!0,xs:6,children:Object(w.jsx)(D,{onPrev:function(){e.goto("prev")},prevIsEnabled:c,children:"".concat(t("Back"))})}),Object(w.jsx)(U.a,{item:!0,xs:6,children:Object(w.jsx)(J,{onNext:function(){e.goto("next")},nextIsEnabled:u,children:"".concat(t("Continue"))})})]}),Object(w.jsx)(q.a,{dialogOpen:F,dialogSetOpen:L,dialogTitle:f,dialogContent:v,dialogButtons:S})]})}M.defaultProps={};var G=o.a.memo(M),H=Object(c.a)((function(e){return{ul:{padding:32}}}));function Y(e){var t=H(),n=Object(s.a)().t,o=Object(a.useState)(!0),c=Object(r.a)(o,1)[0],i=Object(a.useState)(!0),l=Object(r.a)(i,1)[0];return Object(w.jsxs)(E,{children:[Object(w.jsxs)(P,{children:[Object(w.jsx)(z,{children:n("Fill your data")}),Object(w.jsx)(A,{children:"Adesso puoi aprire il modello scaricato con il tuo programma di gestione fogli di lavoro."}),Object(w.jsxs)(A,{children:['Sono presenti 2 fogli: "METADATI" ed "ELENCO GARE". Ti consigliamo di iniziare dal primo foglio, "METADATI", ed inserire i 4 dati generali richiesti:',Object(w.jsxs)("ul",{className:t.ul,children:[Object(w.jsxs)("li",{children:[Object(w.jsx)("i",{children:"codiceFiscaleStrutturaProponente"})," il codice fiscale della tua struttura"]}),Object(w.jsxs)("li",{children:[Object(w.jsx)("i",{children:"denominazioneStrutturaProponente"})," la ragione sociale della tua struttura"]}),Object(w.jsxs)("li",{children:[Object(w.jsx)("i",{children:"annoRiferimento"})," l'anno di riferimento per cui inserirai gli appalti"]}),Object(w.jsxs)("li",{children:[Object(w.jsx)("i",{children:"urlFile"})," l'indirizzo URL dove sar\xe0 pubblicato il documento finale"]})]})]}),Object(w.jsx)(A,{children:'A questo punto puoi passare al secondo foglio, "ELENCO GARE". Occorre inserire ogni appalto (o "gara"), uno per riga.'}),Object(w.jsxs)(A,{children:["I campi da compilare sono:",Object(w.jsxs)("ul",{className:t.ul,children:[Object(w.jsxs)("li",{children:[Object(w.jsx)("i",{children:"CIG"})," il Codice Identificativo Gara"]}),"... TODO: documentare tutti gli altri campi..."]})]})]}),Object(w.jsxs)(U.a,{container:!0,children:[Object(w.jsx)(U.a,{item:!0,xs:6,children:Object(w.jsx)(D,{onPrev:function(){e.goto("prev")},prevIsEnabled:c,children:"".concat(n("Back"))})}),Object(w.jsx)(U.a,{item:!0,xs:6,children:Object(w.jsx)(J,{onNext:function(){e.goto("next")},nextIsEnabled:l,children:"".concat(n("Continue"))})})]})]})}Y.defaultProps={};var _=o.a.memo(Y),V=n(55),Q=n(56),K=n(287),Z={flex:1,display:"flex",flexDirection:"column",alignItems:"center",padding:"20px",borderWidth:2,borderRadius:2,borderColor:"blue",borderStyle:"dashed",backgroundColor:"#fafafa",color:"#353535",outline:"none",transition:"border .24s ease-in-out"},$={backgroundColor:"lightyellow",borderColor:"purple"},ee={backgroundColor:"lightgreen",borderColor:"darkgreen"},te={backgroundColor:"lightred",borderColor:"darkred"},ne=function(e){var t=e.onDrop,n=e.accept,o=Object(s.a)().t,c=Object(K.a)({onDrop:t,accept:n}),r=c.getRootProps,l=c.getInputProps,d=c.isFocused,u=c.isDragAccept,b=c.isDragReject,j=c.isDragActive,p=Object(a.useMemo)((function(){return Object(i.a)(Object(i.a)(Object(i.a)(Object(i.a)({},Z),d?$:{}),u?ee:{}),b?te:{})}),[d,u,b]);return Object(w.jsxs)("div",Object(i.a)(Object(i.a)({className:"dropzone-div"},r({style:p})),{},{children:[Object(w.jsx)("input",Object(i.a)({className:"dropzone-input"},l())),Object(w.jsx)("div",{className:"text-center",children:j?Object(w.jsx)("p",{className:"dropzone-content",children:o("Release to drop the files here")}):Object(w.jsx)("p",{className:"dropzone-content",children:o("Drag 'n drop some files here, or click to select files")})})]}))};function ae(e){var t,n,o,c,l,d,u,b=Object(s.a)().t,j=Object(R.f)(),p=Object(a.useState)(!0),f=Object(r.a)(p,1)[0],O=Object(a.useState)(!(null===e||void 0===e||null===(t=e.job)||void 0===t||!t.file)),m=Object(r.a)(O,2),v=m[0],k=m[1],C=Object(a.useState)(null),y=Object(r.a)(C,2),N=y[0],T=y[1],F=Object(a.useState)(null),L=Object(r.a)(F,2),X=L[0],W=L[1],M=Object(a.useState)([]),G=Object(r.a)(M,2),H=G[0],Y=G[1],_=Object(a.useState)(!1),K=Object(r.a)(_,2),Z=K[0],$=K[1],ee=Object(a.useState)([".csv","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel"]),te=Object(r.a)(ee,1)[0];Object(a.useEffect)((function(){var t,n,a;return!!B.a.getCurrentUser()||(t=b("Please log in or register"),n=b("You need to be authenticated to proceed"),a=[{text:b("Login"),close:!0,callback:function(){h.a.set("redirect",e.job.tabId),j.push("/signin")}},{text:b("Register"),close:!0,callback:function(){return j.push("/signup")}},{text:b("Cancel"),close:!0,callback:function(){return e.goto("prev")}}],T(t),W(n),Y(a),$(!0),!1)}),[e,j,b]);var ae=Object(a.useCallback)(function(){var t=Object(x.a)(g.a.mark((function t(n){return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.setJob(Object(i.a)(Object(i.a)({},e.job),{},{file:n}));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),[e]),oe=Object(a.useCallback)(Object(x.a)(g.a.mark((function t(){var n;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(n={}).tabId=e.job.tabId,e.setJob(n);case 3:case"end":return t.stop()}}),t)}))),[e]),ce=Object(a.useCallback)((function(e){var t,n,a,o;return null!==e&&void 0!==e&&null!==(t=e.type)&&void 0!==t&&null!==(n=t.split("/")[1])&&void 0!==n&&n.match("officedocument.spreadsheetml.sheet")||null!==e&&void 0!==e&&null!==(a=e.type)&&void 0!==a&&null!==(o=a.split("/")[1])&&void 0!==o&&o.match("ms-excel")?null:b("Please upload a spreadsheet")+"."+(null!==e&&void 0!==e&&e.type?" "+b("Selected file looks like {{fileType}}",{fileType:e.type}):"")}),[b]),re=Object(a.useCallback)(function(){var t=Object(x.a)(g.a.mark((function t(n){return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,S.upload(n).then((function(e){console.log("Upload success, file path",e.data.file),ae(e.data.file)}),(function(t){console.error("Upload error:",t),oe(),e.setJob(Object(i.a)(Object(i.a)({},e.job),{},{file:{error:Object(V.c)(t)}})),Q.b.error(Object(V.c)(t))}));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),[e,ae,oe]),ie=Object(a.useCallback)(function(){var t=Object(x.a)(g.a.mark((function t(n){return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=13;break}if(!ce(n)){t.next=7;break}e.setJob(Object(i.a)(Object(i.a)({},e.job),{},{file:null})),k(!1),t.next=11;break;case 7:return e.setJob(Object(i.a)(Object(i.a)({},e.job),{},{file:n})),t.next=10,re(n);case 10:k(!0);case 11:t.next=16;break;case 13:Q.b.error(b("No file selected, sorry... Please, repeat...")),e.setJob(Object(i.a)(Object(i.a)({},e.job),{},{file:null})),k(!1);case 16:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),[e,re,ce,b]),le=Object(a.useCallback)((function(e){console.log("accepted files:",e),ie(e[0])}),[ie]),se=function(){var t=Object(x.a)(g.a.mark((function t(){return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.goto("next");case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return Object(w.jsxs)(E,{children:[Object(w.jsxs)(P,{children:[Object(w.jsx)(z,{children:b("Upload")}),Object(w.jsx)(A,{children:"Carica il foglio Excel compilato:"}),Object(w.jsxs)("div",{className:"container",children:[Object(w.jsx)(ne,{onDrop:le,accept:te}),Object(w.jsx)("br",{}),Object(w.jsxs)(A,{children:[(null===e||void 0===e||null===(n=e.job)||void 0===n||null===(o=n.file)||void 0===o?void 0:o.originalname)&&b("Selected file")+": ".concat(null===e||void 0===e||null===(c=e.job)||void 0===c||null===(l=c.file)||void 0===l?void 0:l.originalname),Object(w.jsx)("br",{}),(null===e||void 0===e||null===(d=e.job)||void 0===d||null===(u=d.file)||void 0===u?void 0:u.originalname)&&Object(w.jsx)(I.a,{variant:"contained",size:"small",color:"default",onClick:oe,title:b("Remove file"),children:" \ud83d\uddd1 "})]})]})]}),Object(w.jsxs)(U.a,{container:!0,children:[Object(w.jsx)(U.a,{item:!0,xs:6,children:Object(w.jsx)(D,{onPrev:function(){e.goto("prev")},prevIsEnabled:f,children:"".concat(b("Back"))})}),Object(w.jsx)(U.a,{item:!0,xs:6,children:Object(w.jsx)(J,{onNext:se,nextIsEnabled:v,children:"".concat(b("Continue"))})})]}),Object(w.jsx)(q.a,{dialogOpen:Z,dialogSetOpen:$,dialogTitle:N,dialogContent:X,dialogButtons:H})]})}ae.defaultProps={};var oe=o.a.memo(ae);function ce(e){var t,n,o,c=Object(s.a)().t,l=Object(R.f)(),d=h.a.getUser(),u=Object(a.useState)({}),b=Object(r.a)(u,2),j=b[0],p=b[1],f=Object(a.useState)(!(null===e||void 0===e||null===(t=e.job)||void 0===t||null===(n=t.transform)||void 0===n||!n.planUpgradeDeclined)),O=Object(r.a)(f,2),m=O[0],v=O[1],k=Object(a.useState)(!0),C=Object(r.a)(k,1)[0],I=Object(a.useState)(null),y=Object(r.a)(I,2),N=y[0],T=y[1],F=Object(a.useState)(null),L=Object(r.a)(F,2),B=L[0],X=L[1],W=Object(a.useState)([]),M=Object(r.a)(W,2),G=M[0],H=M[1],Y=Object(a.useState)(!1),_=Object(r.a)(Y,2),K=_[0],Z=_[1];Object(a.useEffect)((function(){var t,n,a,o,r,s,u,b,j,p;b=c("Please upgrade your plan"),j=c("You need to upgrade your plan to proceed.")+"\n"+c('Your current plan is "'.concat(null===d||void 0===d||null===(t=d.plan)||void 0===t?void 0:t.name,'".'))+"\n"+c("To elaborate ".concat(null===(n=e.job)||void 0===n||null===(a=n.transform)||void 0===a?void 0:a.cigCount,' CIGs you need at least plan "').concat(null===(o=e.job)||void 0===o||null===(r=o.transform)||void 0===r||null===(s=r.planRequired)||void 0===s?void 0:s.name,'"')),p=[{text:c("Upgrade plan"),close:!0,callback:function(){h.a.set("redirect",e.tabId),l.push("/profile")}},{text:c("Proceed with the first ".concat(null===d||void 0===d||null===(u=d.plan)||void 0===u?void 0:u.cigNumberAllowed," CIGs")),callback:function(){var t;v(!0),e.setJob(Object(i.a)(Object(i.a)({},e.job),{},{transform:Object(i.a)(Object(i.a)({},null===(t=e.job)||void 0===t?void 0:t.transform),{},{planUpgradeDeclined:!0})}))},close:!0}],T(b),X(j),H(p)}),[l,e,c]),Object(a.useEffect)((function(){var t,n,a,o,c;if(null!==(t=e.job)&&void 0!==t&&t.transform){if("TRUNCATED_DUE_TO_PLAN_LIMIT"===(null===(n=e.job)||void 0===n||null===(a=n.transform)||void 0===a?void 0:a.code)&&(null===(o=e.job)||void 0===o||null===(c=o.transform)||void 0===c||!c.planUpgradeDeclined))return Z(!0)}else v(!0)}),[null===(o=e.job)||void 0===o?void 0:o.transform]),Object(a.useEffect)((function(){e.job.file&&!e.job.transform&&Object(x.a)(g.a.mark((function t(){return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return p({loading:!0}),t.next=3,S.transformXls2Xml(e.job.file.path).then((function(t){if(t instanceof Error)return e.setJob(Object(i.a)(Object(i.a)({},e.job),{},{transform:t})),Q.b.error(Object(V.c)(t)),p({error:Object(V.c)(t)});e.setJob(Object(i.a)(Object(i.a)({},e.job),{},{transform:t.data.result})),p({success:t.data})}));case 3:case"end":return t.stop()}}),t)})))()}),[e,e.job]),Object(a.useEffect)((function(){e.job.file&&e.job.transform&&!e.job.validateXml&&Object(x.a)(g.a.mark((function t(){return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return p({loading:!0}),t.next=3,S.validateXml(e.job.transform).then((function(t){if(t instanceof Error)return e.setJob(Object(i.a)(Object(i.a)({},e.job),{},{validateXml:t})),Q.b.error(Object(V.c)(t)),p({error:Object(V.c)(t)});e.setJob(Object(i.a)(Object(i.a)({},e.job),{},{validateXml:t.data})),p({success:t.data})}),(function(t){e.setJob(Object(i.a)(Object(i.a)({},e.job),{},{validateXml:t}))}));case 3:case"end":return t.stop()}}),t)})))()}),[e]);return Object(w.jsxs)(E,{children:[Object(w.jsxs)(P,{children:[Object(w.jsx)(z,{children:c("Check")}),Object(w.jsxs)(A,{children:[Object(w.jsxs)("pre",{children:["JOB: ",JSON.stringify(e.job,null,2)]}),j&&"loading"in j&&"Elaborazione in corso...",j&&"error"in j&&"Errore: ".concat(j.error),j&&"success"in j&&"Elaborazione completata"]}),j&&"error"in j&&"Errore: ".concat(j.error)]}),Object(w.jsxs)(U.a,{container:!0,children:[Object(w.jsx)(U.a,{item:!0,xs:6,children:Object(w.jsx)(D,{onPrev:function(){e.goto("prev")},prevIsEnabled:C,children:"".concat(c("Back"))})}),Object(w.jsx)(U.a,{item:!0,xs:6,children:Object(w.jsx)(J,{onNext:function(){e.goto("next")},nextIsEnabled:m,children:"".concat(c("Continue"))})})]}),Object(w.jsx)(q.a,{dialogOpen:K,dialogSetOpen:Z,dialogTitle:N,dialogContent:B,dialogButtons:G})]})}ce.defaultProps={};var re=o.a.memo(ce);function ie(e){var t,n,o,c,l=Object(s.a)().t,d=Object(a.useState)({}),u=Object(r.a)(d,2),b=u[0],j=u[1],p=Object(a.useState)(!1),f=Object(r.a)(p,2),O=f[0],m=f[1],h=Object(a.useState)(!0),v=Object(r.a)(h,1)[0];Object(a.useEffect)((function(){e.job&&e.job.transform&&(e.job.outcome?(m(!0),j({success:"successo"===e.job.outcome.esitoUltimoTentativoAccessoUrl})):Object(x.a)(g.a.mark((function t(){var n,a,o,c,r,l;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return j({loading:!0}),t.next=3,S.outcomeCheck(null===(n=e.job)||void 0===n||null===(a=n.transform)||void 0===a||null===(o=a.metadati)||void 0===o?void 0:o.annoRiferimento,null===(c=e.job)||void 0===c||null===(r=c.transform)||void 0===r||null===(l=r.header)||void 0===l?void 0:l.codiceFiscaleStrutturaProponente).then((function(t){if(t instanceof Error)return Q.b.error(Object(V.c)(t)),j({error:Object(V.c)(t)});e.setJob(Object(i.a)(Object(i.a)({},e.job),{},{outcome:t.data})),j({success:t.data}),m(!0)}),(function(t){return Q.b.error(Object(V.c)(t)),e.setJob(Object(i.a)(Object(i.a)({},e.job),{},{outcome:t.response.data.message})),j({error:Object(V.c)(t)})}));case 3:case"end":return t.stop()}}),t)})))())}),[e.job.transform,e.job.outcome]);return Object(w.jsxs)(E,{children:[Object(w.jsxs)(P,{children:[Object(w.jsx)(z,{children:l("Attendi la validazione da parte dell'ANAC")}),Object(w.jsxs)(A,{children:[b&&"success"in b&&"successo"===(null===(t=e.job)||void 0===t||null===(n=t.outcome)||void 0===n?void 0:n.esitoUltimoTentativoAccessoUrl)&&Object(w.jsxs)("pre",{children:[Object(w.jsx)("img",{src:"images/success.ico",width:"64",alt:"success"})," ",null===(o=e.job)||void 0===o||null===(c=o.outcome)||void 0===c?void 0:c.dataUltimoTentativoAccessoUrl]}),Object(w.jsxs)("pre",{children:["JOB: ",JSON.stringify(e.job,null,2)]})]}),b&&"error"in b&&"Errore: ".concat(b.error)]}),Object(w.jsxs)(U.a,{container:!0,children:[Object(w.jsx)(U.a,{item:!0,xs:6,children:Object(w.jsx)(D,{onPrev:function(){e.goto("prev")},prevIsEnabled:v,children:"".concat(l("Back"))})}),Object(w.jsx)(U.a,{item:!0,xs:6,children:Object(w.jsx)(J,{onNext:function(){e.goto("next")},nextIsEnabled:O,children:"".concat(l("Continue"))})})]})]})}ie.defaultProps={};var le=o.a.memo(ie);function se(e){var t=Object(s.a)().t,n=Object(a.useState)(!0),o=Object(r.a)(n,1)[0];return Object(w.jsxs)(E,{children:[Object(w.jsxs)(P,{children:[Object(w.jsxs)(z,{children:[t("Finished"),"!"]}),Object(w.jsx)(A,{children:Object(w.jsx)("div",{style:{fontSize:128,textAlign:"center"},children:"\ud83c\udfc1"})})]}),Object(w.jsx)(U.a,{container:!0,children:Object(w.jsx)(U.a,{item:!0,xs:6,children:Object(w.jsx)(D,{onPrev:function(){e.goto("prev")},prevIsEnabled:o,children:"".concat(t("Back"))})})})]})}se.defaultProps={};var de=o.a.memo(se),ue=["children","value","index"];function be(e){var t=e.children,n=e.value,a=e.index,o=Object(l.a)(e,ue);return Object(w.jsx)(O.a,Object(i.a)(Object(i.a)({component:"div",role:"tabpanel",hidden:n!==a,id:"scrollable-auto-tabpanel-".concat(a),"aria-labelledby":"nav-tab-".concat(a)},o),{},{children:Object(w.jsx)(m.a,{p:3,children:t})}))}var je=function(e){return{id:"nav-tab-".concat(e),"aria-controls":"nav-tabpanel-".concat(e)}},pe=Object(d.a)((function(e){return{root:{opacity:.8}}}))((function(e){return Object(w.jsx)(f.a,Object(i.a)({},e))})),fe=Object(u.a)((function(e){return{root:{flexGrow:1},tabs:{"& .MuiTabs-indicator":{backgroundColor:"orange"}}}})),Oe=function(){var e=fe(),t=Object(a.useState)((function(){return h.a.getJob()})),n=Object(r.a)(t,2),o=n[0],c=n[1],l=Object(s.a)().t;function d(e){c(Object(i.a)(Object(i.a)({},o),{},{tabId:e}))}function u(e){var t=e;if("string"===typeof e)switch(e.toLowerCase()){case"start":case"download":case"fill your data":case"upload":case"check":case"wait for validation":case"finish!":break;case"next":t=o?o.tabId+1:0;break;case"prev":t=o?o.tabId-1:0;break;default:return void console.error("Unforeseen where specification in goto: ".concat(e))}d(t)}return Object(a.useEffect)((function(){var e=h.a.get("redirect");console.log("REDIRECT:",e),e&&(c(Object(i.a)(Object(i.a)({},o),{},{tabId:e})),h.a.remove("redirect"))}),[o]),Object(a.useEffect)((function(){console.log("--------------- TabsPanel useEffect setjob, job:",o),h.a.setJob(o),S.set(o)}),[o]),null!==o&&void 0!==o&&o.tabId||(o.tabId=0),console.log("TabsPanel render - job.tabId:",null===o||void 0===o?void 0:o.tabId,"job:",o),Object(w.jsxs)("div",{className:e.root,children:[Object(w.jsx)(b.a,{position:"fixed",elevation:0,style:{top:50},children:Object(w.jsx)(j.a,{elevation:0,square:!0,children:Object(w.jsxs)(p.a,{value:null===o||void 0===o?void 0:o.tabId,variant:"scrollable",scrollButtons:"auto",onChange:function(e,t){W.a.ui.userCanForceTabChange&&d(t)},"aria-label":"current section",children:[Object(w.jsx)(pe,Object(i.a)({label:"".concat(l("Start")," \ud83e\ude84")},je(0))),Object(w.jsx)(pe,Object(i.a)({label:"".concat(l("Download")," \u2b07")},je(1))),Object(w.jsx)(pe,Object(i.a)({label:"".concat(l("Fill your data")," \ud83d\udd8b")},je(2))),Object(w.jsx)(pe,Object(i.a)({label:"".concat(l("Upload")," \u2b06")},je(3))),Object(w.jsx)(pe,Object(i.a)({label:"".concat(l("Check")," \u2714")},je(4))),Object(w.jsx)(pe,Object(i.a)({label:"".concat(l("Wait for validation")," \ud83c\udfaf")},je(5))),Object(w.jsx)(pe,Object(i.a)({label:"".concat(l("Finish!")," \ud83c\udfc1")},je(6)))]})})}),Object(w.jsxs)(w.Fragment,{children:[0===(null===o||void 0===o?void 0:o.tabId)&&Object(w.jsx)(be,{index:0,value:o.tabId,children:Object(w.jsx)(L,{goto:u,job:o,setJob:function(e){return c(e)}})}),1===(null===o||void 0===o?void 0:o.tabId)&&Object(w.jsx)(be,{index:1,value:o.tabId,children:Object(w.jsx)(G,{goto:u,job:o,setJob:function(e){return c(e)}})}),2===(null===o||void 0===o?void 0:o.tabId)&&Object(w.jsx)(be,{index:2,value:o.tabId,children:Object(w.jsx)(_,{goto:u,job:o,setJob:function(e){return c(e)}})}),3===(null===o||void 0===o?void 0:o.tabId)&&Object(w.jsx)(be,{index:3,value:o.tabId,children:Object(w.jsx)(oe,{goto:u,job:o,setJob:function(e){return c(e)}})}),4===(null===o||void 0===o?void 0:o.tabId)&&Object(w.jsx)(be,{index:4,value:o.tabId,children:Object(w.jsx)(re,{goto:u,job:o,setJob:function(e){return c(e)}})}),5===(null===o||void 0===o?void 0:o.tabId)&&Object(w.jsx)(be,{index:5,value:o.tabId,children:Object(w.jsx)(le,{goto:u,job:o,setJob:function(e){return c(e)}})}),6===(null===o||void 0===o?void 0:o.tabId)&&Object(w.jsx)(be,{index:6,value:o.tabId,children:Object(w.jsx)(de,{goto:u,job:o,setJob:function(e){return c(e)}})})]})]})},me=Object(c.a)((function(e){return{home:{fontSize:"1.5em"}}}));function he(){var e=me();return Object(w.jsx)("div",{className:e.home,children:Object(w.jsx)(Oe,{})})}t.default=o.a.memo(he)}}]);
//# sourceMappingURL=12.f0dfef25.chunk.js.map