(this["webpackJsonpappalti190-client"]=this["webpackJsonpappalti190-client"]||[]).push([[15],{305:function(e,t,n){"use strict";var a=n(21),o=n(311),c=n(0),r=n.n(c),i=n(291),l=n(359),s=n(345),d=n(360),b=n(361),u=n(362),j=n(1),f=["title","contentText","actions"],O=function(e){var t=e.title,n=e.contentText,c=e.actions,r=Object(o.a)(e,f);return Object(j.jsxs)(l.a,Object(a.a)(Object(a.a)({},r),{},{onBackdropClick:function(){},"aria-labelledby":t,onClose:function(e,t){},children:[Object(j.jsx)(s.a,{children:t}),Object(j.jsx)(d.a,{children:Object(j.jsx)(b.a,{children:n})}),Object(j.jsx)(u.a,{children:c.map((function(e,t){return Object(j.jsx)(i.a,{onClick:function(){e.callback&&e.callback(),e.closeModal&&r.onClose()},variant:"primary"===e.variant?"contained":"secondary"===e.variant?"outlined":"contained",autoFocus:r,style:{textTransform:"none"},children:e.text},t)}))})]}))};O.defaultProps={title:"",contentText:"",actions:[{text:"Ok",closeModal:!0,callback:function(){},variant:"primary",autoFocus:!1}]},t.a=r.a.memo(O)},314:function(e,t,n){"use strict";var a=n(104),o=n(87),c=n.n(o),r=n(31),i=n(45),l=function(){var e=Object(a.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i.a.getUser()){e.next=3;break}return e.abrupt("return",null);case 3:return e.next=5,r.a.get("/job/get");case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),s={get:l,set:function(e){return i.a.getUser()?r.a.put("/job/set",{job:e}):null},upload:function(e){var t=new FormData;return t.append("file",e),r.a.post("/job/upload",t,{headers:{"Content-Type":"multipart/form-data"}})},transformXls2Xml:function(e){return r.a.post("/job/transformXls2Xml/:filePath",{filePath:e})},validateXml:function(e){return r.a.post("/job/validateXml/:transform",{transform:e})},outcomeCheck:function(e,t){return r.a.post("/job/outcomeCheck/:anno/:codiceFiscaleAmministrazione",{anno:e,codiceFiscaleAmministrazione:t})},outcomeFailureDetails:function(e,t){return r.a.post("/job/outcomeFailureDetails/anno/codiceFiscaleAmministrazione",{anno:e,codiceFiscaleAmministrazione:t})},urlExistenceCheck:function(e){return r.a.post("/job/urlExistenceCheck/url",e)},sanitizeJob:function(e){var t;if(null===e||void 0===e||null===(t=e.transform)||void 0===t||!t.xml)return e;var n=e;return n.transform.xml="\u2026",n},getPlans:function(){return r.a.get("/job/getPlans")}};t.a=s},450:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),c=n(284),r=n(14),i=n(21),l=n(311),s=n(293),d=n(460),b=n(296),u=n(300),j=n(451),f=n(461),O=n(295),p=n(411),x=n(45),h=n(314),v=n(291),m=n(463);var g=n(1),k=Object(c.a)((function(e){return{paragraph:{fontSize:"1.1em"},paragraphSmall:{fontSize:"0.8em"},centered:{display:"flex",justifyContent:"center",alignItems:"center"},justified:{textAlign:"justify"},box:{display:"flex"},boxLeft:{justifyContent:"flex-start"},boxRight:{justifyContent:"flex-end"},sup:{fontSize:"0.8em"},scrollableContainer:{display:"flex",flexDirection:"column",marginTop:"1em",minHeight:"5em"},scrollable:{height:"100%",overflowY:"auto",paddingLeft:10,paddingRight:10,minHeight:"3em"}}})),w=o.a.memo((function(e){return Object(g.jsx)("div",{children:e.children})}));w.defaultProps={};var C=o.a.memo((function(e){var t=k(),n=function(){var e=Object(a.useState)({width:window.innerWidth,height:window.innerHeight}),t=Object(r.a)(e,2),n=t[0],o=t[1];return Object(a.useEffect)((function(){function e(){o({width:window.innerWidth,height:window.innerHeight})}return window.addEventListener("resize",e),e(),function(){return window.removeEventListener("resize",e)}}),[]),n}();return Object(g.jsx)("div",{className:t.scrollableContainer,children:Object(g.jsx)("div",{className:t.scrollable,style:{height:Math.max(120,n.height-90-100-60)},children:e.children})})}));C.defaultProps={};var I=o.a.memo((function(e){var t=k();return Object(g.jsx)("div",{className:t.centered,children:Object(g.jsx)("h2",{children:e.children})})}));I.defaultProps={};var E=o.a.memo((function(e){var t=k();return Object(g.jsx)(p.a,{mb:1,children:Object(g.jsx)(O.a,{component:"div",className:"".concat(t.paragraph," ").concat(t.justified," ").concat(e.small?t.paragraphSmall:null," ").concat(e.class),children:e.children})})}));E.defaultProps={class:null};var y=o.a.memo((function(e){var t=k();return Object(g.jsx)(p.a,{component:"span",m:1,className:"".concat(t.box," ").concat(t.boxLeft),children:Object(g.jsx)(v.a,{variant:"contained",color:"secondary",onClick:e.onPrev,disabled:!e.prevIsEnabled,children:e.children})})}));y.defaultProps={};var P=o.a.memo((function(e){var t=k();return Object(g.jsx)(p.a,{component:"span",m:1,className:"".concat(t.box," ").concat(t.boxRight),children:Object(g.jsx)(v.a,{variant:"contained",color:"secondary",onClick:e.onNext,disabled:!e.nextIsEnabled,children:e.children})})}));P.defaultProps={};var S=o.a.memo((function(e){var t=k();return Object(g.jsx)(m.a,{title:e.title,placement:"top",children:Object(g.jsx)("sup",{className:t.sup,children:e.anchor})})}));function N(e){var t=Object(s.a)().t,n=Object(a.useState)(!0),o=Object(r.a)(n,1)[0];return Object(g.jsxs)(w,{children:[Object(g.jsxs)(C,{children:[Object(g.jsx)(I,{children:t("Welcome!")}),Object(g.jsxs)(E,{children:["Questa \xe8 la nostra proposta per adempiere i requisiti della "," ",Object(g.jsx)("a",{href:"https://www.anticorruzione.it/-/adempimenti-legge-190/2012-art.-1-comma-32-7",target:"legge190",children:"Legge 190"}),". Speriamo che sia chiara e semplice da usare."]}),Object(g.jsx)(E,{children:"Questa app ti guider\xe0 passo passo nei pochi passi che occorrono per completare l'adempimento con successo."}),Object(g.jsxs)(E,{children:["Per iniziare dovrai scaricare un modello Excel",Object(g.jsx)(S,{title:"Pu\xf2 essere in formato MicroSoft-Excel, oppure in formato ODS, come preferisci."}),", che contiene delle regole per guidarti nella compilazione, e minimizzare i possibili errori formali."]}),Object(g.jsx)(E,{children:"Poi dovrai inserire, uno per riga, tutti i beni o servizi che la tua struttura ha appaltato nell'anno in corso."}),Object(g.jsx)(E,{children:"Alla fine dell'anno, in genere entro la fine di Gennaio dell'anno successivo, sar\xe0 sufficiente caricare qui il foglio Excel compilato."}),Object(g.jsx)(E,{children:"A questo punto il nostro sistema effettuer\xe0 il controllo formale dei dati inseriti. Nel caso che venga segnalata qualche anomalia dovrai correggere sul file Excel le anomalie segnalate, e poi ri-caricarlo."}),Object(g.jsx)(E,{children:"Dopodich\xe8 potrai scaricare il documento XML prodotto, che andr\xe0 pubblicato sul sito cui fa riferimento la tua struttura."}),Object(g.jsx)(E,{children:"A questo punto avrai praticamente completato l'adempimento. Se vorrai potrai controllare - sempre su questo sito - l'esito della verifica da parte dell'ANAC."}),Object(g.jsx)(E,{children:'Tieni presente che siamo sempre disponibili a risponderti per qualsiasi dubbio o incertezza. Le modalit\xe0 di assistenza sono diverse, dal supporto telefonico a quello per email, e dipendono anche dal piano scelto. I riferimenti sono presenti nel menu, alla voce "Supporto".'})]}),Object(g.jsx)("div",{children:Object(g.jsx)(P,{onNext:function(){e.goto("next")},nextIsEnabled:o,children:t("Start")})})]})}S.defaultProps={anchor:"*"},N.defaultProps={};var J=o.a.memo(N),D=n(18),z=n(108),A=n(289),U=n(59),F=n(305),T=n(20),M=n.n(T),R=n(75);function L(e){var t=Object(s.a)().t,n=Object(D.f)(),o=Object(a.useState)(!0),c=Object(r.a)(o,1)[0],l=Object(a.useState)((function(){var t,n;return!(null===(t=e.job)||void 0===t||!t.download)&&(null===(n=e.job)||void 0===n?void 0:n.download)})),d=Object(r.a)(l,2),b=d[0],u=d[1],j=Object(z.b)().showModal,f=function(){return!!U.a.getCurrentUser()||(function(e){j(F.a,e)}({title:t("Please log in or register"),contentText:t("You need to be authenticated to proceed"),actions:[{text:t("Login"),closeModal:!0,autoFocus:!0,callback:function(){x.a.set("redirect",e.tabId),n.push("/signin")}},{text:t("Register"),closeModal:!0,callback:function(){x.a.set("redirect",e.tabId),n.push("/signup")}},{text:t("Cancel"),closeModal:!0,callback:function(){return e.goto("prev")}}]}),!1)};return Object(g.jsxs)(w,{children:[Object(g.jsxs)(C,{children:[Object(g.jsx)(I,{children:t("Download")}),Object(g.jsx)(E,{children:"Scarica il modello Excel in cui potrai inserire i dati degli appalti, uno per riga."}),Object(g.jsx)(E,{children:Object(g.jsxs)(v.a,{onClick:function(){f()&&(Object(R.c)(M.a.data.templateDownloadUrl),u(!0),e.setJob(Object(i.a)(Object(i.a)({},e.job),{},{download:!0})))},variant:"contained",color:"tertiary",children:[t("Download")," \u2b07"]})})]}),Object(g.jsxs)(A.a,{container:!0,children:[Object(g.jsx)(A.a,{item:!0,xs:6,children:Object(g.jsx)(y,{onPrev:function(){e.goto("prev")},prevIsEnabled:c,children:t("Back")})}),Object(g.jsx)(A.a,{item:!0,xs:6,children:Object(g.jsx)(P,{onNext:function(){e.goto("next")},nextIsEnabled:b,children:t("Continue")})})]})]})}L.defaultProps={};var X=o.a.memo(L),B=Object(c.a)((function(e){return{ul:{padding:32}}}));function q(e){var t=B(),n=Object(s.a)().t,o=Object(a.useState)(!0),c=Object(r.a)(o,1)[0],i=Object(a.useState)(!0),l=Object(r.a)(i,1)[0];return Object(g.jsxs)(w,{children:[Object(g.jsxs)(C,{children:[Object(g.jsx)(I,{children:n("Fill your data")}),Object(g.jsx)(E,{children:"Adesso puoi aprire il modello scaricato con il tuo programma di gestione fogli di lavoro."}),Object(g.jsxs)(E,{children:['Sono presenti 2 fogli: "METADATI" ed "ELENCO GARE".',Object(g.jsx)("br",{}),'Ti consigliamo di iniziare dal primo foglio, "METADATI", ed inserire i 4 dati generali richiesti:',Object(g.jsxs)("ul",{className:t.ul,children:[Object(g.jsxs)("li",{children:[Object(g.jsx)("i",{children:"codiceFiscaleStrutturaProponente"})," il codice fiscale della tua struttura"]}),Object(g.jsxs)("li",{children:[Object(g.jsx)("i",{children:"denominazioneStrutturaProponente"})," la ragione sociale della tua struttura"]}),Object(g.jsxs)("li",{children:[Object(g.jsx)("i",{children:"annoRiferimento"})," l'anno di riferimento per cui inserirai gli appalti"]}),Object(g.jsxs)("li",{children:[Object(g.jsx)("i",{children:"urlFile"})," l'indirizzo URL dove sar\xe0 pubblicato il documento finale"]})]})]}),Object(g.jsx)(E,{children:'A questo punto puoi passare al secondo foglio, "ELENCO GARE". Occorre inserire ogni appalto (o "gara"), uno per riga.'}),Object(g.jsxs)(E,{children:["I campi da compilare sono:",Object(g.jsxs)("ul",{className:t.ul,children:[Object(g.jsxs)("li",{children:[Object(g.jsx)("i",{children:"CIG"})," il Codice Identificativo Gara"]}),"... TODO: documentare tutti gli altri campi..."]})]})]}),Object(g.jsxs)(A.a,{container:!0,children:[Object(g.jsx)(A.a,{item:!0,xs:6,children:Object(g.jsx)(y,{onPrev:function(){e.goto("prev")},prevIsEnabled:c,children:n("Back")})}),Object(g.jsx)(A.a,{item:!0,xs:6,children:Object(g.jsx)(P,{onNext:function(){e.goto("next")},nextIsEnabled:l,children:n("Continue")})})]})]})}q.defaultProps={};var G=o.a.memo(q),W=n(104),Y=n(87),H=n.n(Y),_=n(76),Q=n(409),V={flex:1,display:"flex",flexDirection:"column",alignItems:"center",padding:"20px",borderWidth:2,borderRadius:2,borderColor:"blue",borderStyle:"dashed",backgroundColor:"#fafafa",color:"#353535",outline:"none",transition:"border .24s ease-in-out"},K={backgroundColor:"lightyellow",borderColor:"purple"},Z={backgroundColor:"lightgreen",borderColor:"darkgreen"},$={backgroundColor:"lightred",borderColor:"darkred"},ee=function(e){var t=e.onDrop,n=e.accept,o=Object(s.a)().t,c=Object(Q.a)({onDrop:t,accept:n}),r=c.getRootProps,l=c.getInputProps,d=c.isFocused,b=c.isDragAccept,u=c.isDragReject,j=c.isDragActive,f=Object(a.useMemo)((function(){return Object(i.a)(Object(i.a)(Object(i.a)(Object(i.a)({},V),d?K:{}),b?Z:{}),u?$:{})}),[d,b,u]);return Object(g.jsxs)("div",Object(i.a)(Object(i.a)({className:"dropzone-div"},r({style:f})),{},{children:[Object(g.jsx)("input",Object(i.a)({className:"dropzone-input"},l())),Object(g.jsx)("div",{className:"text-center",children:j?Object(g.jsx)("p",{className:"dropzone-content",children:o("Release to drop the files here")}):Object(g.jsx)("p",{className:"dropzone-content",children:o("Drag 'n drop some files here, or click to select files")})})]}))};function te(e){var t,n,o,c,l,d,b,u=Object(s.a)().t,j=Object(D.f)(),f=Object(a.useState)(!0),O=Object(r.a)(f,1)[0],p=Object(a.useState)(!(null===e||void 0===e||null===(t=e.job)||void 0===t||!t.file)),m=Object(r.a)(p,2),k=m[0],S=m[1],N=Object(z.b)().showModal,J=Object(a.useState)([".csv","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel"]),T=Object(r.a)(J,1)[0];Object(a.useEffect)((function(){return!!U.a.getCurrentUser()||(function(e){N(F.a,e)}({title:u("Please log in or register"),contentText:u("You need to be authenticated to proceed"),actions:[{text:u("Login"),closeModal:!0,autoFocus:!0,callback:function(){x.a.set("redirect",e.tabId),j.push("/signin")}},{text:u("Register"),closeModal:!0,callback:function(){x.a.set("redirect",e.tabId),j.push("/signup")}},{text:u("Cancel"),closeModal:!0,callback:function(){return e.goto("prev")}}]}),!1)}),[e]);var M=Object(a.useCallback)(function(){var t=Object(W.a)(H.a.mark((function t(n){return H.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.setJob(Object(i.a)(Object(i.a)({},e.job),{},{file:n}));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),[e]),L=Object(a.useCallback)(Object(W.a)(H.a.mark((function t(){var n;return H.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(n={}).tabId=e.job.tabId,e.setJob(n),S(!1);case 4:case"end":return t.stop()}}),t)}))),[e]),X=Object(a.useCallback)((function(e){var t,n,a,o;return null!==e&&void 0!==e&&null!==(t=e.type)&&void 0!==t&&null!==(n=t.split("/")[1])&&void 0!==n&&n.match("officedocument.spreadsheetml.sheet")||null!==e&&void 0!==e&&null!==(a=e.type)&&void 0!==a&&null!==(o=a.split("/")[1])&&void 0!==o&&o.match("ms-excel")?null:u("Please upload a spreadsheet")+"."+(null!==e&&void 0!==e&&e.type?" "+u("Selected file looks like {{fileType}}",{fileType:e.type}):"")}),[u]),B=Object(a.useCallback)(function(){var t=Object(W.a)(H.a.mark((function t(n){return H.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h.a.upload(n).then((function(e){console.log("Upload success, file path",e.data.file),M(e.data.file)}),(function(t){console.error("Upload error:",t),L(),e.setJob(Object(i.a)(Object(i.a)({},e.job),{},{file:{error:Object(R.f)(t)}})),_.b.error(Object(R.f)(t))}));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),[e,M,L]),q=Object(a.useCallback)(function(){var t=Object(W.a)(H.a.mark((function t(n){return H.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=13;break}if(!X(n)){t.next=7;break}e.setJob(Object(i.a)(Object(i.a)({},e.job),{},{file:null})),S(!1),t.next=11;break;case 7:return e.setJob(Object(i.a)(Object(i.a)({},e.job),{},{file:n})),t.next=10,B(n);case 10:S(!0);case 11:t.next=16;break;case 13:_.b.error(u("No file selected, sorry... Please, repeat...")),e.setJob(Object(i.a)(Object(i.a)({},e.job),{},{file:null})),S(!1);case 16:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),[e,B,X,u]),G=Object(a.useCallback)((function(e){console.log("accepted files:",e),q(e[0])}),[q]),Y=function(){var t=Object(W.a)(H.a.mark((function t(){return H.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.goto("next");case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return Object(g.jsxs)(w,{children:[Object(g.jsxs)(C,{children:[Object(g.jsx)(I,{children:u("Upload")}),Object(g.jsx)(E,{children:"Carica il foglio Excel compilato:"}),Object(g.jsxs)("div",{className:"container",children:[Object(g.jsx)(ee,{onDrop:G,accept:T}),Object(g.jsx)("br",{}),Object(g.jsxs)(E,{children:[(null===e||void 0===e||null===(n=e.job)||void 0===n||null===(o=n.file)||void 0===o?void 0:o.originalname)&&u("Selected file")+": ".concat(null===e||void 0===e||null===(c=e.job)||void 0===c||null===(l=c.file)||void 0===l?void 0:l.originalname),Object(g.jsx)("br",{}),(null===e||void 0===e||null===(d=e.job)||void 0===d||null===(b=d.file)||void 0===b?void 0:b.originalname)&&Object(g.jsx)(v.a,{variant:"contained",size:"small",onClick:L,title:u("Remove file"),children:" \ud83d\uddd1 "})]})]})]}),Object(g.jsxs)(A.a,{container:!0,children:[Object(g.jsx)(A.a,{item:!0,xs:6,children:Object(g.jsx)(y,{onPrev:function(){e.goto("prev")},prevIsEnabled:O,children:u("Back")})}),Object(g.jsx)(A.a,{item:!0,xs:6,children:Object(g.jsx)(P,{onNext:Y,nextIsEnabled:k,children:u("Continue")})})]})]})}te.defaultProps={};var ne=o.a.memo(te);function ae(e){var t,n,o,c=Object(s.a)().t,l=Object(D.f)(),d=x.a.getUser(),b=Object(a.useState)({}),u=Object(r.a)(b,2),j=u[0],f=u[1],O=Object(a.useState)(!(null===e||void 0===e||null===(t=e.job)||void 0===t||null===(n=t.transform)||void 0===n||!n.planUpgradeDeclined)),p=Object(r.a)(O,2),v=p[0],m=p[1],k=Object(a.useState)(!0),S=Object(r.a)(k,1)[0],N=Object(z.b)().showModal;Object(a.useEffect)((function(){var t,n,a,o,r,s,b,u,j,f,O,p;(console.log("useeffect 1"),null!==(t=e.job)&&void 0!==t&&t.transform)?"TRUNCATED_DUE_TO_PLAN_LIMIT"===(null===(n=e.job)||void 0===n||null===(a=n.transform)||void 0===a?void 0:a.code)&&(null!==(o=e.job)&&void 0!==o&&null!==(r=o.transform)&&void 0!==r&&r.planUpgradeDeclined||function(e){N(F.a,e)}({title:c("Please upgrade your plan"),contentText:c("You need to upgrade your plan to proceed.")+"\n"+c('Your current plan is "{{planName}}".',{planName:null===d||void 0===d||null===(s=d.plan)||void 0===s?void 0:s.name})+"\n"+c('To elaborate {{cigCount}} CIGs you need at least plan "{{planName}}"',{cigCount:null===(b=e.job)||void 0===b||null===(u=b.transform)||void 0===u?void 0:u.cigCount,planName:null===(j=e.job)||void 0===j||null===(f=j.transform)||void 0===f||null===(O=f.planRequired)||void 0===O?void 0:O.name}),actions:[{text:c("Upgrade plan"),closeModal:!0,autoFocus:!0,callback:function(){x.a.set("redirect",e.tabId),l.push("/profile",{tabValue:1})}},{text:c("Proceed with the first {{cigNumberAllowed}} CIGs",{cigNumberAllowed:null===d||void 0===d||null===(p=d.plan)||void 0===p?void 0:p.cigNumberAllowed}),closeModal:!0,callback:function(){var t;m(!0),e.setJob(Object(i.a)(Object(i.a)({},e.job),{},{transform:Object(i.a)(Object(i.a)({},null===(t=e.job)||void 0===t?void 0:t.transform),{},{planUpgradeDeclined:!0})}))}}]})):m(!0)}),[null===(o=e.job)||void 0===o?void 0:o.transform]),Object(a.useEffect)((function(){console.log("useeffect 2"),e.job.file&&!e.job.transform&&Object(W.a)(H.a.mark((function t(){return H.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return f({loading:!0}),t.next=3,h.a.transformXls2Xml(e.job.file.path).then((function(t){if(t instanceof Error)return e.setJob(Object(i.a)(Object(i.a)({},e.job),{},{transform:t})),_.b.error(Object(R.f)(t)),f({error:Object(R.f)(t)});e.setJob(Object(i.a)(Object(i.a)({},e.job),{},{transform:t.data.result})),f({success:t.data})}));case 3:case"end":return t.stop()}}),t)})))()}),[]),Object(a.useEffect)((function(){console.log("useeffect 3"),e.job.file&&e.job.transform&&!e.job.validateXml&&Object(W.a)(H.a.mark((function t(){return H.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return f({loading:!0}),t.next=3,h.a.validateXml(e.job.transform).then((function(t){if(t instanceof Error)return e.setJob(Object(i.a)(Object(i.a)({},e.job),{},{validateXml:t})),_.b.error(Object(R.f)(t)),f({error:Object(R.f)(t)});e.setJob(Object(i.a)(Object(i.a)({},e.job),{},{validateXml:t.data})),f({success:t.data})}),(function(t){e.setJob(Object(i.a)(Object(i.a)({},e.job),{},{validateXml:t}))}));case 3:case"end":return t.stop()}}),t)})))()}),[]);return console.log(e.job),Object(g.jsxs)(w,{children:[Object(g.jsxs)(C,{children:[Object(g.jsx)(I,{children:c("Check")}),Object(g.jsxs)(E,{children:[Object(g.jsxs)("pre",{children:["JOB: ",JSON.stringify(e.job,null,2)]}),j&&"loading"in j&&"Elaborazione in corso...",j&&"error"in j&&"Errore: ".concat(j.error),j&&"success"in j&&"Elaborazione completata"]}),j&&"error"in j&&"Errore: ".concat(j.error)]}),Object(g.jsxs)(A.a,{container:!0,children:[Object(g.jsx)(A.a,{item:!0,xs:6,children:Object(g.jsx)(y,{onPrev:function(){e.goto("prev")},prevIsEnabled:S,children:c("Back")})}),Object(g.jsx)(A.a,{item:!0,xs:6,children:Object(g.jsx)(P,{onNext:function(){e.goto("next")},nextIsEnabled:v,children:c("Continue")})})]})]})}ae.defaultProps={};var oe=o.a.memo(ae);function ce(e){var t=Object(s.a)().t,n=Object(D.f)(),o=Object(a.useState)(!0),c=Object(r.a)(o,1)[0],l=Object(a.useState)((function(){var t,n;return!(null===(t=e.job)||void 0===t||!t.download)&&(null===(n=e.job)||void 0===n?void 0:n.downloadDataset)})),d=Object(r.a)(l,2),b=d[0],u=d[1],j=Object(z.b)().showModal,f=function(){return!!U.a.getCurrentUser()||(function(e){j(F.a,e)}({title:t("Please log in or register"),contentText:t("You need to be authenticated to proceed"),actions:[{text:t("Login"),closeModal:!0,autoFocus:!0,callback:function(){x.a.set("redirect",e.tabId),n.push("/signin")}},{text:t("Register"),closeModal:!0,callback:function(){x.a.set("redirect",e.tabId),n.push("/signup")}},{text:t("Cancel"),closeModal:!0,callback:function(){return e.goto("prev")}}]}),!1)};return Object(g.jsxs)(w,{children:[Object(g.jsxs)(C,{children:[Object(g.jsx)(I,{children:t("Download produced dataset")}),Object(g.jsx)(E,{children:Object(g.jsxs)("p",{children:[t("Download dataset"),"."]})}),Object(g.jsx)(E,{children:Object(g.jsxs)(v.a,{onClick:function(){if(f()){var t=e.job.transform.outputUrl;console.log("job:",e.job),console.log("url:",t),Object(R.d)(t),u(!0),e.setJob(Object(i.a)(Object(i.a)({},e.job),{},{downloadDataset:!0}))}},variant:"contained",color:"tertiary",children:[t("Download")," \u2935"]})})]}),Object(g.jsxs)(A.a,{container:!0,children:[Object(g.jsx)(A.a,{item:!0,xs:6,children:Object(g.jsx)(y,{onPrev:function(){e.goto("prev")},prevIsEnabled:c,children:t("Back")})}),Object(g.jsx)(A.a,{item:!0,xs:6,children:Object(g.jsx)(P,{onNext:function(){e.goto("next")},nextIsEnabled:b,children:t("Continue")})})]})]})}ce.defaultProps={};var re=o.a.memo(ce);function ie(e){var t=Object(s.a)().t,n=Object(a.useState)({}),o=Object(r.a)(n,2),c=o[0],l=o[1],d=Object(a.useState)(!0),b=Object(r.a)(d,1)[0],u=Object(a.useState)((function(){var t,n;return!(null===(t=e.job)||void 0===t||!t.download)&&(null===(n=e.job)||void 0===n?void 0:n.downloadDataset)})),j=Object(r.a)(u,2),f=j[0],O=j[1],p=Object(a.useState)(!1),x=Object(r.a)(p,2),m=x[0],k=x[1],S=e.job.transform.metadati.urlFile;function N(){return(N=Object(W.a)(H.a.mark((function e(){return H.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:k(!0);case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Object(a.useEffect)((function(){e.job&&e.job.transform&&Object(W.a)(H.a.mark((function t(){return H.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return l({loading:!0}),k(!1),t.next=4,h.a.urlExistenceCheck({url:S}).then((function(t){if(t instanceof Error)return _.b.error(Object(R.f)(t)),l({loading:!1,error:Object(R.f)(t)});e.setJob(Object(i.a)(Object(i.a)({},e.job),{},{datasetIsPublished:t.data})),l({loading:!1,success:!0}),O(t.data)}),(function(t){return _.b.error(Object(R.f)(t)),e.setJob(Object(i.a)(Object(i.a)({},e.job),{},{outcome:t.response.data.message})),l({error:Object(R.f)(t)})}));case 4:case"end":return t.stop()}}),t)})))()}),[e.job.transform,e.job.outcome,m]);var J=void 0===c.loading||c.loading?"\ud83d\udfe1":e.job.datasetIsPublished?"\ud83d\udfe2 ".concat(t("Dataset is correctly published at address {{publishUrlFile}}",{publishUrlFile:S})):"\ud83d\udd34 ".concat(t("Dataset is not published yet at address {{publishUrlFile}}",{publishUrlFile:S}));return Object(g.jsxs)(w,{children:[Object(g.jsxs)(C,{children:[Object(g.jsx)(I,{children:t("Publish downloaded dataset")}),Object(g.jsx)("br",{}),Object(g.jsx)(E,{children:J}),Object(g.jsx)(E,{children:!e.job.datasetIsPublished&&Object(g.jsxs)("span",{children:[Object(g.jsxs)("p",{children:[t("Please provide to publish downloaded dataset"),"."]}),Object(g.jsx)("p",{children:Object(g.jsxs)(v.a,{onClick:function(){return N.apply(this,arguments)},variant:"contained",color:"tertiary",children:[t("Verify publication now")," \ud83c\udf0d"]})})]})})]}),Object(g.jsxs)(A.a,{container:!0,children:[Object(g.jsx)(A.a,{item:!0,xs:6,children:Object(g.jsx)(y,{onPrev:function(){e.goto("prev")},prevIsEnabled:b,children:t("Back")})}),Object(g.jsx)(A.a,{item:!0,xs:6,children:Object(g.jsx)(P,{onNext:function(){e.goto("next")},nextIsEnabled:f,children:t("Continue")})})]})]})}ie.defaultProps={};var le=o.a.memo(ie);function se(e){var t,n,o,c,l=Object(s.a)().t,d=Object(a.useState)({}),b=Object(r.a)(d,2),u=b[0],j=b[1],f=Object(a.useState)(!1),O=Object(r.a)(f,2),p=O[0],x=O[1],v=Object(a.useState)(!0),m=Object(r.a)(v,1)[0];Object(a.useEffect)((function(){e.job&&e.job.transform&&(e.job.outcome?(x(!0),j({success:"successo"===e.job.outcome.esitoUltimoTentativoAccessoUrl})):Object(W.a)(H.a.mark((function t(){var n,a,o,c,r,l;return H.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return j({loading:!0}),t.next=3,h.a.outcomeCheck(null===(n=e.job)||void 0===n||null===(a=n.transform)||void 0===a||null===(o=a.metadati)||void 0===o?void 0:o.annoRiferimento,null===(c=e.job)||void 0===c||null===(r=c.transform)||void 0===r||null===(l=r.header)||void 0===l?void 0:l.codiceFiscaleStrutturaProponente).then((function(t){if(t instanceof Error)return _.b.error(Object(R.f)(t)),j({error:Object(R.f)(t)});e.setJob(Object(i.a)(Object(i.a)({},e.job),{},{outcome:t.data})),j({success:t.data}),x(!0)}),(function(t){return _.b.error(Object(R.f)(t)),e.setJob(Object(i.a)(Object(i.a)({},e.job),{},{outcome:t.response.data.message})),j({error:Object(R.f)(t)})}));case 3:case"end":return t.stop()}}),t)})))())}),[e.job.transform,e.job.outcome]);return Object(g.jsxs)(w,{children:[Object(g.jsxs)(C,{children:[Object(g.jsx)(I,{children:l("Wait for ANAC validation")}),Object(g.jsxs)(E,{children:[u&&"success"in u&&"successo"===(null===(t=e.job)||void 0===t||null===(n=t.outcome)||void 0===n?void 0:n.esitoUltimoTentativoAccessoUrl)&&Object(g.jsxs)("pre",{children:[Object(g.jsx)("span",{style:{color:"green",fontSize:"1.7em"},children:"\u2713"})," ",null===(o=e.job)||void 0===o||null===(c=o.outcome)||void 0===c?void 0:c.dataUltimoTentativoAccessoUrl]}),Object(g.jsxs)("pre",{children:["JOB: ",JSON.stringify(e.job,null,2)]})]}),u&&"error"in u&&"Errore: ".concat(u.error)]}),Object(g.jsxs)(A.a,{container:!0,children:[Object(g.jsx)(A.a,{item:!0,xs:6,children:Object(g.jsx)(y,{onPrev:function(){e.goto("prev")},prevIsEnabled:m,children:l("Back")})}),Object(g.jsx)(A.a,{item:!0,xs:6,children:Object(g.jsx)(P,{onNext:function(){e.goto("next")},nextIsEnabled:p,children:l("Continue")})})]})]})}se.defaultProps={};var de=o.a.memo(se);function be(e){var t=Object(s.a)().t,n=Object(a.useState)(!0),o=Object(r.a)(n,1)[0];return Object(g.jsxs)(w,{children:[Object(g.jsxs)(C,{children:[Object(g.jsxs)(I,{children:[t("Finished"),"!"]}),Object(g.jsx)(E,{children:Object(g.jsx)("div",{style:{fontSize:128,textAlign:"center"},children:"\ud83c\udfc1"})})]}),Object(g.jsx)(A.a,{container:!0,children:Object(g.jsx)(A.a,{item:!0,xs:6,children:Object(g.jsx)(y,{onPrev:function(){e.goto("prev")},prevIsEnabled:o,children:t("Back")})})})]})}be.defaultProps={};var ue=o.a.memo(be),je=["children","value","index"];function fe(e){var t=e.children,n=e.value,a=e.index,o=Object(l.a)(e,je);return Object(g.jsx)(O.a,Object(i.a)(Object(i.a)({component:"div",role:"tabpanel",hidden:n!==a,id:"scrollable-auto-tabpanel-".concat(a),"aria-labelledby":"nav-tab-".concat(a)},o),{},{children:Object(g.jsx)(p.a,{p:3,children:t})}))}var Oe=function(e){return{id:"nav-tab-".concat(e),"aria-controls":"nav-tabpanel-".concat(e)}},pe=Object(d.a)((function(e){return{root:{opacity:.8}}}))((function(e){return Object(g.jsx)(f.a,Object(i.a)({},e))})),xe=Object(c.a)((function(e){return{root:{flexGrow:1},tab:{backgroundColor:e.palette.secondary.light},tabIndicator:{backgroundColor:"MediumSeaGreen",height:3}}})),he=function(){var e=xe(),t=Object(a.useState)((function(){return x.a.getJob()})),n=Object(r.a)(t,2),o=n[0],c=n[1],l=Object(s.a)().t;function d(e){c(Object(i.a)(Object(i.a)({},o),{},{tabId:e}))}function f(e){var t=e;if("string"===typeof e)switch(e.toLowerCase()){case"start":case"download template":case"fill your data":case"upload":case"check":case"download dataset":case"publish":case"wait for validation":case"finish!":break;case"next":t=o?o.tabId+1:0;break;case"prev":t=o?o.tabId-1:0;break;default:return void console.error("Unforeseen where specification in goto: ".concat(e))}d(t)}return Object(a.useEffect)((function(){var e=x.a.get("redirect");e&&(c(Object(i.a)(Object(i.a)({},o),{},{tabId:e})),x.a.remove("redirect"))}),[o]),Object(a.useEffect)((function(){x.a.setJob(o),h.a.set(o)}),[o]),null!==o&&void 0!==o&&o.tabId||(o.tabId=0),Object(g.jsxs)("div",{className:e.root,children:[Object(g.jsx)(b.a,{elevation:0,position:"fixed",style:{top:50},children:Object(g.jsx)(u.a,{elevation:1,square:!0,children:Object(g.jsxs)(j.a,{value:null===o||void 0===o?void 0:o.tabId,variant:"scrollable",scrollButtons:"auto",onChange:function(e,t){M.a.ui.userCanForceTabChange&&d(t)},"aria-label":"current section",classes:{indicator:e.tabIndicator},className:e.tab,children:[Object(g.jsx)(pe,Object(i.a)({label:"".concat(l("Start")," \ud83e\ude84")},Oe(0))),Object(g.jsx)(pe,Object(i.a)({label:"".concat(l("Download template")," \u25bc")},Oe(1))),Object(g.jsx)(pe,Object(i.a)({label:"".concat(l("Fill your data")," \ud83d\udd8b")},Oe(2))),Object(g.jsx)(pe,Object(i.a)({label:"".concat(l("Upload")," \u25b2")},Oe(3))),Object(g.jsx)(pe,Object(i.a)({label:"".concat(l("Check")," \u2705")},Oe(4))),Object(g.jsx)(pe,Object(i.a)({label:"".concat(l("Download dataset")," \u2935")},Oe(5))),Object(g.jsx)(pe,Object(i.a)({label:"".concat(l("Publish")," \ud83c\udf0d")},Oe(6))),Object(g.jsx)(pe,Object(i.a)({label:"".concat(l("Wait for validation")," \ud83c\udfaf")},Oe(7))),Object(g.jsx)(pe,Object(i.a)({label:"".concat(l("Finish!")," \ud83c\udfc1")},Oe(8)))]})})}),Object(g.jsxs)(g.Fragment,{children:[0===(null===o||void 0===o?void 0:o.tabId)&&Object(g.jsx)(fe,{index:0,value:o.tabId,children:Object(g.jsx)(J,{goto:f,job:o,setJob:function(e){return c(e)}})}),1===(null===o||void 0===o?void 0:o.tabId)&&Object(g.jsx)(fe,{index:1,value:o.tabId,children:Object(g.jsx)(X,{goto:f,job:o,setJob:function(e){return c(e)}})}),2===(null===o||void 0===o?void 0:o.tabId)&&Object(g.jsx)(fe,{index:2,value:o.tabId,children:Object(g.jsx)(G,{goto:f,job:o,setJob:function(e){return c(e)}})}),3===(null===o||void 0===o?void 0:o.tabId)&&Object(g.jsx)(fe,{index:3,value:o.tabId,children:Object(g.jsx)(ne,{goto:f,job:o,setJob:function(e){return c(e)}})}),4===(null===o||void 0===o?void 0:o.tabId)&&Object(g.jsx)(fe,{index:4,value:o.tabId,children:Object(g.jsx)(oe,{goto:f,job:o,setJob:function(e){return c(e)}})}),5===(null===o||void 0===o?void 0:o.tabId)&&Object(g.jsx)(fe,{index:5,value:o.tabId,children:Object(g.jsx)(re,{goto:f,job:o,setJob:function(e){return c(e)}})}),6===(null===o||void 0===o?void 0:o.tabId)&&Object(g.jsx)(fe,{index:6,value:o.tabId,children:Object(g.jsx)(le,{goto:f,job:o,setJob:function(e){return c(e)}})}),7===(null===o||void 0===o?void 0:o.tabId)&&Object(g.jsx)(fe,{index:7,value:o.tabId,children:Object(g.jsx)(de,{goto:f,job:o,setJob:function(e){return c(e)}})}),8===(null===o||void 0===o?void 0:o.tabId)&&Object(g.jsx)(fe,{index:8,value:o.tabId,children:Object(g.jsx)(ue,{goto:f,job:o,setJob:function(e){return c(e)}})})]})]})},ve=Object(c.a)((function(e){return{home:{fontSize:"1.5em"}}}));function me(){var e=ve();return Object(g.jsx)("div",{className:e.home,children:Object(g.jsx)(he,{})})}t.default=o.a.memo(me)}}]);
//# sourceMappingURL=15.be9f654f.chunk.js.map