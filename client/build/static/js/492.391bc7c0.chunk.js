"use strict";(self.webpackChunkappalti190_client=self.webpackChunkappalti190_client||[]).push([[492],{6492:function(e,n,r){r.r(n),r.d(n,{default:function(){return le}});var o=r(390),i=r(1846),t=r(4890),a=r(6515),l=r(3738),c=r(3721),s=r(6533),u=r(8020),d=r(3769),f=r(6990),p=r(2951),h=r(7637),m=r(1395),x=r(8282),v=r(2420),g=r(5240);var j=r(2559),b=(0,i.Z)((function(e){return{paragraph:{fontSize:"1.1em"},paragraphSmall:{fontSize:"0.8em"},centered:{display:"flex",justifyContent:"center",alignItems:"center"},justified:{textAlign:"justify"},box:{display:"flex"},boxRight:{justifyContent:"flex-end"},sup:{fontSize:"0.8em"},scrollableContainer:{display:"flex",flexDirection:"column",marginTop:"1em",minHeight:"5em"},scrollable:{height:"100%",overflowY:"auto",paddingLeft:10,paddingRight:10,minHeight:"3em"}}})),Z=o.memo((function(e){return(0,j.jsx)("div",{children:e.children})}));Z.defaultProps={};var w=o.memo((function(e){var n=b(),r=function(){var e=(0,o.useState)({width:window.innerWidth,height:window.innerHeight}),n=(0,t.Z)(e,2),r=n[0],i=n[1];return(0,o.useEffect)((function(){function e(){i({width:window.innerWidth,height:window.innerHeight}),console.log("useWindowSize - height:",window.innerHeight)}return window.addEventListener("resize",e),e(),function(){return window.removeEventListener("resize",e)}}),[]),r}();return(0,j.jsx)("div",{className:n.scrollableContainer,children:(0,j.jsx)("div",{className:n.scrollable,style:{height:Math.max(120,r.height-90-100-60)},children:e.children})})}));w.defaultProps={};var k=o.memo((function(e){var n=b();return(0,j.jsx)("div",{className:n.centered,children:(0,j.jsx)("h2",{children:e.children})})}));k.defaultProps={};var E=o.memo((function(e){var n=b();return(0,j.jsx)(x.Z,{mb:1,children:(0,j.jsx)(m.Z,{component:"div",className:"".concat(n.paragraph," ").concat(n.justified," ").concat(e.small?n.paragraphSmall:null," ").concat(e.class),children:e.children})})}));E.defaultProps={class:null};var C=o.memo((function(e){var n=b();return(0,j.jsx)(x.Z,{component:"span",m:1,className:"".concat(n.box," ").concat(n.boxRight),children:(0,j.jsx)(v.Z,{variant:"contained",color:"secondary",onClick:e.onNext,disabled:!e.nextIsEnabled,children:e.children})})}));C.defaultProps={};var S=o.memo((function(e){var n=b();return(0,j.jsx)(g.ZP,{title:e.title,placement:"top",children:(0,j.jsx)("sup",{className:n.sup,children:e.anchor})})}));function y(e){var n=(0,c.$)().t,r=(0,o.useState)(!0),i=(0,t.Z)(r,1)[0];return(0,j.jsxs)(Z,{children:[(0,j.jsxs)(w,{children:[(0,j.jsx)(k,{children:n("Welcome!")}),(0,j.jsxs)(E,{children:["Questa \xe8 la nostra proposta per adempiere i requisiti della "," ",(0,j.jsx)("a",{href:"https://www.anticorruzione.it/-/adempimenti-legge-190/2012-art.-1-comma-32-7",target:"legge190",children:"Legge 190"}),". Speriamo che sia chiara e semplice da usare."]}),(0,j.jsx)(E,{children:"Questa app ti guider\xe0 passo passo nei pochi steps che occorrono per completare l'adempimento con successo."}),(0,j.jsxs)(E,{children:["Per iniziare dovrai scaricare un modello Excel",(0,j.jsx)(S,{title:"Pu\xf2 essere in formato MicroSoft-Excel, oppure in formato ODS, come preferisci."}),", che contiene delle regole per guidarti nella compilazione, e minimizzare i possibili errori formali."]}),(0,j.jsx)(E,{children:"Poi dovrai inserire, uno per riga, tutti i beni o servizi che la tua struttura ha appaltato nell'anno in corso."}),(0,j.jsx)(E,{children:"Alla fine dell'anno, in genere entro la fine di Gennaio dell'anno successivo, sar\xe0 sufficiente caricare qui il foglio Excel compilato."}),(0,j.jsx)(E,{children:"A questo punto il nostro sistema effettuer\xe0 il controllo formale dei dati inseriti. Nel caso che venga segnalato qualche anomalia dovrai correggere sul file Excel le anomalie segnalate, e poi ri-caricarlo."}),(0,j.jsx)(E,{children:"Dopodich\xe8 potrai scaricare il documento XML prodotto, che andr\xe0 pubblicato sul sito cui fa riferimento la tua struttura."}),(0,j.jsx)(E,{children:"A questo punto avrai praticamente completato l'adempimento. Se vorrai potrai controllare - sempre su questo sito - l'esito della verifica da parte dell'ANAC."}),(0,j.jsx)(E,{children:'Tieni presente che siamo sempre disponibili a risponderti per qualsiasi dubbio o incertezza. Le modalit\xe0 di assistenza sono diverse, dal supporto telefonico a quello per email, e dipendono anche dal piano scelto. I riferimenti sono presenti nel menu, alla voce "Supporto".'})]}),(0,j.jsx)("div",{children:(0,j.jsx)(C,{onNext:function(){e.goto("next")},nextIsEnabled:i,children:"".concat(n("Start"))})})]})}S.defaultProps={anchor:"*"},y.defaultProps={};var D=o.memo(y),N=r(2600),A=r.n(N);function P(e){var n=(0,c.$)().t,r=(0,o.useState)(!1),i=(0,t.Z)(r,2),a=i[0],l=i[1];return(0,j.jsxs)(Z,{children:[(0,j.jsxs)(w,{children:[(0,j.jsx)(k,{children:n("Download")}),(0,j.jsx)(E,{children:"Scarica il modello Excel in cui potrai inserire i dati degli appalti, uno per riga."}),(0,j.jsx)(E,{children:(0,j.jsxs)(v.Z,{onClick:function(){var e=document.createElement("a");e.download=A().data.templateDownloadName,e.href=A().data.templateDownloadLink,e.click(),l(!0)},variant:"contained",color:"primary",children:[n("Download")," \u2b07"]})})]}),(0,j.jsx)(C,{onNext:function(){e.goto("next")},nextIsEnabled:a,children:"".concat(n("Continue"))})]})}P.defaultProps={};var z=o.memo(P),T=(0,i.Z)((function(e){return{xul:{padding:15}}}));function X(e){var n=T(),r=(0,c.$)().t,i=(0,o.useState)(!0),a=(0,t.Z)(i,1)[0];return(0,j.jsxs)(Z,{children:[(0,j.jsxs)(w,{children:[(0,j.jsx)(k,{children:r("Fill your data")}),(0,j.jsx)(E,{children:"Adesso puoi aprire il modello scaricato con il tuo programma di gestione fogli di lavoro."}),(0,j.jsxs)(E,{children:['Sono presenti 2 fogli: "METADATI" ed "ELENCO GARE". Ti consigliamo di iniziare dal primo foglio, "METADATI", ed inserire i 4 dati generali richiesti:',(0,j.jsxs)("ul",{className:n.ul,children:[(0,j.jsxs)("li",{children:[(0,j.jsx)("i",{children:"codiceFiscaleStrutturaProponente"})," il codice fiscale della tua struttura"]}),(0,j.jsxs)("li",{children:[(0,j.jsx)("i",{children:"denominazioneStrutturaProponente"})," la ragione sociale della tua struttura"]}),(0,j.jsxs)("li",{children:[(0,j.jsx)("i",{children:"annoRiferimento"})," l'anno di riferimento per cui inserirai gli appalti"]}),(0,j.jsxs)("li",{children:[(0,j.jsx)("i",{children:"urlFile"})," l'indirizzo URL dove sar\xe0 pubblicato il documento finale"]})]})]}),(0,j.jsx)(E,{children:'A questo punto puoi passare al secondo foglio, "ELENCO GARE". Occorre inserire ogni appalto (o "gara"), uno per riga.'}),(0,j.jsxs)(E,{children:["I campi da compilare sono:",(0,j.jsxs)("ul",{className:n.ul,children:[(0,j.jsxs)("li",{children:[(0,j.jsx)("i",{children:"CIG"})," il Codice Identificativo Gara"]}),"... TODO: documentare tutti gli altri campi..."]})]})]}),(0,j.jsx)(C,{onNext:function(){e.goto("next")},nextIsEnabled:a,children:"".concat(r("Continue"))})]})}X.defaultProps={};var L=o.memo(X),F=r(3032),I=r(4322),O=r.n(I);var q=r(5892),R=r(4479),U={upload:function(e){var n=new FormData;return n.append("file",e),R.Z.post("/job/upload",n,{headers:{"Content-Type":"multipart/form-data"}})},transformXls2Xml:function(e){return R.Z.post("/job/transformXls2Xml/filePath",{filePath:e})},validateXml:function(e){return R.Z.post("/job/validateXml/transform",{transform:e})},outcomeCheck:function(){return R.Z.post("/job/outcomeCheck",{})},outcomeFailureDetails:function(e,n){return R.Z.post("/job/outcomeFailureDetails/anno/codiceFiscaleAmministrazione",{anno:e,codiceFiscaleAmministrazione:n})}},$=(0,i.Z)((function(e){return{fileDropLabel:{display:"inline-block",textAlign:"center",width:"100%",border:"3px black dashed",padding:"3em 1.78em",cursor:"pointer",backgroundColor:"#f0f0f0"},fileDropError:{display:"inline-block",fontSize:"1.0em",fontStyle:"italic",fontWeight:"bold",color:"darkred",marginTop:"1em"}}}));function G(e){var n=$(),r=(0,c.$)().t,i=(0,o.useContext)(q.o),a=i.service,l=i.setService,s=(0,o.useState)(!1),u=(0,t.Z)(s,2),d=u[0],f=u[1],p=(0,o.useState)(null),h=(0,t.Z)(p,2),m=h[0],x=h[1],g=function(){var e=(0,o.useState)(!1),n=(0,t.Z)(e,2),r=n[0],i=n[1],a=(0,o.useState)(null),l=(0,t.Z)(a,2),c=l[0],s=l[1];return{dragOver:r,setDragOver:i,onDragOver:function(e){e.preventDefault(),e.dataTransfer.dropEffect="copy",i(!0)},onDragLeave:function(e){i(!1)},fileDropError:c,setFileDropError:s}}(),b=g.dragOver,S=g.setDragOver,y=g.onDragOver,D=g.onDragLeave,N=g.fileDropError,A=g.setFileDropError,P=function(e){if(S(!1),e){var n=z(e);n?(A(n),x(null),f(!1)):(A(null),x(e),f(!0))}else A(r("No file selected, sorry... Please, repeat...")),x(null),f(!1)},z=function(e){var n,o,i,t;return null!==e&&void 0!==e&&null!==(n=e.type)&&void 0!==n&&null!==(o=n.split("/")[1])&&void 0!==o&&o.match("officedocument.spreadsheetml.sheet")||null!==e&&void 0!==e&&null!==(i=e.type)&&void 0!==i&&null!==(t=i.split("/")[1])&&void 0!==t&&t.match("ms-excel")?null:(console.log("FILE:",e),console.log("FILE.TYPE:",null===e||void 0===e?void 0:e.type),r("Please upload a spreadsheet")+"."+(null!==e&&void 0!==e&&e.type?" "+r("Selected file looks like {{fileType}}",{fileType:e.type}):""))},T=function(){var e=(0,F.Z)(O().mark((function e(){return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U.upload(m).then((function(e){console.log("Upload success, file path",e.data.file),l({file:e.data.file}),console.log("service:",a)}),(function(e){console.error("Upload error:",e)}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),X=function(){var n=(0,F.Z)(O().mark((function n(){return O().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,T();case 2:e.goto("next");case 3:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();return(0,j.jsxs)(Z,{children:[(0,j.jsxs)(w,{children:[(0,j.jsx)(k,{children:r("Upload")}),(0,j.jsx)(E,{children:"Carica il foglio Excel compilato:"}),(0,j.jsxs)("div",{className:"container",children:[(0,j.jsxs)("form",{children:[(0,j.jsx)("label",{htmlFor:"file",onDragOver:y,onDragLeave:D,onDrop:function(e){var n;e.preventDefault();var r=null===e||void 0===e||null===(n=e.dataTransfer)||void 0===n?void 0:n.files[0];P(r)},style:{backgroundColor:"".concat(b?"#ffdd00":"")},className:n.fileDropLabel,children:(0,j.jsx)("span",{style:{color:"".concat(b?"black":"#444")},children:r("Drop the file here or click to select from disk")})}),(0,j.jsx)("input",{type:"file",name:"file",id:"file",onChange:function(e){var n;e.preventDefault();var r=null===e||void 0===e||null===(n=e.target)||void 0===n?void 0:n.files[0];P(r)},style:{display:"none"}})]}),N&&(0,j.jsx)("div",{className:n.fileDropError,children:N}),(0,j.jsx)("br",{}),(0,j.jsxs)(E,{children:[m&&r("File caricato: ".concat(m.name)),(0,j.jsx)("br",{}),m&&(0,j.jsx)(v.Z,{variant:"contained",size:"small",color:"default",onClick:function(e){x(null),document.getElementById("file").value="",A(""),f(!1),S(!1)},title:r("Remove file"),children:" \ud83d\uddd1 "})]})]})]}),(0,j.jsx)(C,{onNext:X,nextIsEnabled:d,children:"".concat(r("Continue"))})]})}G.defaultProps={};var W=o.memo(G),H=r(4100),M=r(3137);function _(e){var n=(0,c.$)().t,r=(0,o.useContext)(q.o),i=r.service,l=r.setService,s=(0,o.useState)({}),u=(0,t.Z)(s,2),d=u[0],f=u[1],p=(0,o.useState)(!1),h=(0,t.Z)(p,2),m=h[0],x=h[1];(0,o.useEffect)((function(){console.log("Tab05Check 1 props, service:",e,i),e.active&&(console.log("Tab05Check 1 props active"),i.file&&!i.transform&&(console.log("Tab05Check 1 file && !transform: calling transform"),(0,F.Z)(O().mark((function e(){return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f({loading:!0}),e.next=3,U.transformXls2Xml(i.file.path).then(function(){var e=(0,F.Z)(O().mark((function e(n){return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("transform response:",n),n){e.next=5;break}return H.A.error((0,M.N3)(n.message)),f({error:n.message}),e.abrupt("return");case 5:console.log("transform success:",n.data),l((0,a.Z)((0,a.Z)({},i),{},{transform:n.data.result})),f({success:n.data});case 8:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),(function(e){console.error("transformXls2Xml error:",e),l((0,a.Z)((0,a.Z)({},i),{},{transform:e})),H.A.error((0,M.N3)(e))}));case 3:case"end":return e.stop()}}),e)})))()))}),[e,i]),(0,o.useEffect)((function(){console.log("Tab05Check 2 props, service:",e,i),e.active&&(console.log("Tab05Check 2 props active"),i.file&&i.transform&&!i.validateXml&&(console.log("Tab05Check 2 file && transform !validate: calling validate"),(0,F.Z)(O().mark((function e(){return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f({loading:!0}),e.next=3,U.validateXml(i.transform).then((function(e){if(console.log("validate response:",e),!e)return l((0,a.Z)((0,a.Z)({},i),{},{validateXml:"no response"})),H.A.error((0,M.N3)(e.message)),void f({error:e.message});console.log("validate success:",e.data),l((0,a.Z)((0,a.Z)({},i),{},{validateXml:e.data.result})),f({success:e.data}),x(!0)}),(function(e){l((0,a.Z)((0,a.Z)({},i),{},{validateXml:e})),H.A.error((0,M.N3)(e))}));case 3:case"end":return e.stop()}}),e)})))()))}),[e,i]);return(0,j.jsxs)(Z,{children:[(0,j.jsxs)(w,{children:[(0,j.jsx)(k,{children:n("Check")}),(0,j.jsxs)(E,{children:[d&&"loading"in d&&"Elaborazione in corso...",d&&"error"in d&&"Errore: ".concat(d.error),d&&"success"in d&&"Elaborazione completata"]}),d&&"error"in d&&"Errore: ".concat(d.error),(d&&"success"in d||d&&"error"in d)&&(0,j.jsx)("pre",{children:JSON.stringify(i,null,2)})]}),(0,j.jsx)(C,{onNext:function(){e.goto("next")},nextIsEnabled:m,children:"".concat(n("Continue"))})]})}_.defaultProps={};var B=o.memo(_);function J(e){var n=(0,c.$)().t,r=(0,o.useContext)(q.o),i=r.service,l=r.setService,s=(0,o.useState)({}),u=(0,t.Z)(s,2),d=u[0],f=u[1],p=(0,o.useState)(!1),h=(0,t.Z)(p,2),m=h[0],x=h[1];(0,o.useEffect)((function(){console.log("PROPS:",e),e.value===e.index&&(i.outcome||(0,F.Z)(O().mark((function e(){return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f({loading:!0}),e.next=3,U.outcomeCheck().then((function(e){if(console.log("outcomeCheck XXX:",e),!e)return H.A.error((0,M.N3)(e.message)),void f({error:e.message});console.log("outcomeCheck success:",e.data),l((0,a.Z)((0,a.Z)({},i),{},{outcome:e.data.result})),f({success:e.data}),x(!0)}),(function(e){console.error("outcome check error:",e),H.A.error((0,M.N3)(e))}));case 3:case"end":return e.stop()}}),e)})))())}),[e]);return(0,j.jsxs)(Z,{children:[(0,j.jsxs)(w,{children:[(0,j.jsx)(k,{children:n("Attendi la validazione da parte dell'ANAC")}),(0,j.jsx)(E,{}),d&&"error"in d&&"Errore: ".concat(d.error),d&&"success"in d&&"successo"===i.outcome.esitoUltimoTentativoAccessoUrl&&(0,j.jsxs)("pre",{children:[(0,j.jsx)("img",{src:"images/success.ico",width:"64",alt:"success"})," ",i.outcome.dataUltimoTentativoAccessoUrl]}),(d&&"success"in d||d&&"error"in d)&&(0,j.jsx)("pre",{children:JSON.stringify(i,null,2)})]}),(0,j.jsx)(C,{onNext:function(){e.goto("next")},nextIsEnabled:m,children:"".concat(n("Continue"))})]})}J.defaultProps={};var Q=o.memo(J);function Y(e){var n=(0,c.$)().t,r=(0,o.useState)({}),i=(0,t.Z)(r,2),a=i[0],l=i[1];return(0,o.useEffect)((function(){console.log("PROPS:",e),e.value===e.index&&(0,F.Z)(O().mark((function e(){return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:l({loading:!0});case 1:case"end":return e.stop()}}),e)})))()}),[e]),(0,j.jsx)(Z,{children:(0,j.jsxs)(w,{children:[(0,j.jsx)(k,{children:n("Finished! \ud83c\udfc1")}),(0,j.jsx)(E,{}),a&&"error"in a&&"Errore: ".concat(a.error)]})})}Y.defaultProps={};var K=o.memo(Y),V=["children","value","index"];function ee(e){var n=e.children,r=e.value,o=e.index,i=(0,l.Z)(e,V);return(0,j.jsx)(m.Z,(0,a.Z)((0,a.Z)({component:"div",role:"tabpanel",hidden:r!==o,id:"scrollable-auto-tabpanel-".concat(o),"aria-labelledby":"nav-tab-".concat(o)},i),{},{children:(0,j.jsx)(x.Z,{p:3,children:n})}))}var ne=function(e){return{id:"nav-tab-".concat(e),"aria-controls":"nav-tabpanel-".concat(e)}},re=(0,s.Z)((function(e){return{root:{opacity:.8}}}))((function(e){return(0,j.jsx)(h.Z,(0,a.Z)({},e))})),oe=(0,u.Z)((function(e){return{root:{flexGrow:1}}})),ie=function(){var e=oe(),n=(0,c.$)().t,r=(0,o.useState)(0),i=(0,t.Z)(r,2),l=i[0],s=i[1];function u(e){var n=e;if("string"===typeof e)switch(e.toLowerCase()){case"start":case"download":case"fill your data":case"upload":case"check":case"wait for validation":case"finish!":break;case"next":n=l+1;break;case"prev":n=l-1;break;default:return void console.error("Unforeseen where specification in goto: ".concat(e))}s(n)}return(0,j.jsxs)("div",{className:e.root,children:[(0,j.jsx)(d.Z,{position:"fixed",elevation:0,style:{top:50},children:(0,j.jsx)(f.Z,{elevation:0,square:!0,children:(0,j.jsxs)(p.Z,{value:l,variant:"scrollable",scrollButtons:"auto",onChange:function(e,n){console.log("handleChangeTab id:",n),s(n)},"aria-label":"current section",children:[(0,j.jsx)(re,(0,a.Z)({label:"".concat(n("Start")," \ud83e\ude84")},ne(0))),(0,j.jsx)(re,(0,a.Z)({label:"".concat(n("Download")," \u2b07")},ne(1))),(0,j.jsx)(re,(0,a.Z)({label:"".concat(n("Fill your data")," \ud83d\udd8b")},ne(2))),(0,j.jsx)(re,(0,a.Z)({label:"".concat(n("Upload")," \u2b06")},ne(3))),(0,j.jsx)(re,(0,a.Z)({label:"".concat(n("Check")," \u2714")},ne(4))),(0,j.jsx)(re,(0,a.Z)({label:"".concat(n("Wait for validation")," \ud83c\udfaf")},ne(5))),(0,j.jsx)(re,(0,a.Z)({label:"".concat(n("Finish!")," \ud83c\udfc1")},ne(6)))]})})}),(0,j.jsx)(ee,{value:l,index:0,children:(0,j.jsx)(D,{active:0===l,goto:function(e){return u(e)}})}),(0,j.jsx)(ee,{value:l,index:1,children:(0,j.jsx)(z,{active:1===l,goto:function(e){return u(e)}})}),(0,j.jsx)(ee,{value:l,index:2,children:(0,j.jsx)(L,{active:2===l,goto:function(e){return u(e)}})}),(0,j.jsx)(ee,{value:l,index:3,children:(0,j.jsx)(W,{active:3===l,goto:function(e){return u(e)}})}),(0,j.jsx)(ee,{value:l,index:4,children:(0,j.jsx)(B,{active:4===l,_value:l,_index:4,goto:function(e){return u(e)}})}),(0,j.jsx)(ee,{value:l,index:5,children:(0,j.jsx)(Q,{active:5===l,value:l,index:5,goto:function(e){return u(e)}})}),(0,j.jsx)(ee,{value:l,index:6,children:(0,j.jsx)(K,{active:6===l,value:l,index:6,goto:function(e){return u(e)}})})]})},te=(0,i.Z)((function(e){return{home:{fontSize:"1.5em"}}}));function ae(){var e=te();return(0,j.jsx)("div",{className:e.home,children:(0,j.jsx)(ie,{})})}var le=o.memo(ae)}}]);
//# sourceMappingURL=492.391bc7c0.chunk.js.map