{"version":3,"sources":["services/UserService.js","components/PaymentRedirect.js"],"names":["UserService","getProfile","api","get","then","response","data","error","updateProfile","email","password","firstName","lastName","address","fiscalCode","businessName","post","updateUserProperty","userId","propertyName","propertyValue","getPlans","plans","updatePlan","plan","console","log","getRoles","roles","updateRoles","getPublicContent","getUserBoard","getModeratorBoard","getAdminBoard","getAdminPanel","PaymentRedirect","props","history","useHistory","t","useTranslation","useLocation","pathname","search","useEffect","status","match","planName","URLSearchParams","result","Error","toast","errorMessage","EventBus","dispatch","success","warn","push","tabValue","React","memo"],"mappings":"+HAAA,YA6HMA,EAAc,CAClBC,WA5HiB,WACjB,OAAOC,IAAIC,IAAI,oBAAoBC,MACjC,SAAAC,GACE,OAAOA,EAASC,QAElB,SAAAC,GACE,OAAOA,MAuHXC,cAlHoB,SAAC,GAA6F,IAA9EC,EAA6E,EAA7EA,MAAOC,EAAsE,EAAtEA,SAAUC,EAA4D,EAA5DA,UAAWC,EAAiD,EAAjDA,SAAUC,EAAuC,EAAvCA,QAASC,EAA8B,EAA9BA,WAAYC,EAAkB,EAAlBA,aAC/F,OAAOb,IAAIc,KAAK,sBAAuB,CAErCP,QACAC,WACAC,YACAC,WACAC,UACAC,aACAC,iBACCX,MACD,SAAAC,GACE,OAAOA,EAASC,QAElB,SAAAC,GACE,OAAOA,MAoGXU,mBA/FyB,SAAC,GAA2C,IAA1CC,EAAyC,EAAzCA,OAAQC,EAAiC,EAAjCA,aAAcC,EAAmB,EAAnBA,cACjD,OAAOlB,IAAIc,KAAK,2BAA4B,CAC1CE,SACAC,eACAC,kBACChB,MACD,SAAAC,GACE,OAAOA,EAASC,QAElB,SAAAC,GACE,OAAOA,MAsFXc,SAjFe,SAAAC,GACf,OAAOpB,IAAIC,IAAI,kBAAkBC,MAC/B,SAAAC,GACE,OAAOA,EAASC,QAElB,SAAAC,GACE,OAAOA,MA4EXgB,WAvEiB,SAAAC,GAEjB,OADAC,QAAQC,IAAI,qBAAsBF,GAC3BtB,IAAIc,KAAK,mBACdQ,GACApB,MACA,SAAAC,GACE,OAAOA,EAASC,QAElB,SAAAC,GACE,OAAOA,MA+DXoB,SA1De,SAAAC,GACf,OAAO1B,IAAIC,IAAI,kBAAkBC,MAC/B,SAAAC,GACE,OAAOA,EAASC,QAElB,SAAAC,GACE,OAAOA,MAqDXsB,YAhDkB,SAAAD,GAClB,OAAO1B,IAAIc,KAAK,oBACdY,GACAxB,MACA,SAAAC,GACE,OAAOA,EAASC,QAElB,SAAAC,GACE,OAAOA,MAyCXuB,iBApCuB,WACvB,OAAO5B,IAAIC,IAAI,cAoCf4B,aAjCmB,WACnB,OAAO7B,IAAIC,IAAI,eAiCf6B,kBA9BwB,WACxB,OAAO9B,IAAIC,IAAI,cA8Bf8B,cA3BoB,WACpB,OAAO/B,IAAIC,IAAI,gBA2Bf+B,cAxBoB,WACpB,OAAOhC,IAAIC,IAAI,wBACbC,MACA,SAACC,GACC,OAAOA,EAASC,QAElB,SAACC,GACC,OAAOA,OAoBEP,O,iCC5If,oFAQA,SAASmC,EAAgBC,GACvB,IAAMC,EAAUC,cACRC,EAAMC,cAAND,EACR,EAA6BE,cAArBC,EAAR,EAAQA,SAAUC,EAAlB,EAAkBA,OAmClB,OAjCAC,qBAAU,WACR,IAAMC,EACJH,EAASI,MAAM,oBAAsB,UACrCJ,EAASI,MAAM,mBAAqB,SACpC,UAGIC,EADc,IAAIC,gBAAgBL,GACXxC,IAAI,WAElB,YAAX0C,EACF7C,IAAYuB,WAAW,CACrBC,KAAMuB,IACL3C,MACD,SAAA6C,GACE,GAAIA,aAAkBC,MAGpB,OAFAzB,QAAQlB,MAAM,uBAAwB0C,QACtCE,IAAM5C,MAAM6C,YAAaH,IAG3BxB,QAAQC,IAAI,oCAAqCuB,GACjDI,IAASC,SAAS,eAClBH,IAAMI,QAAQhB,EAAE,iCAKpBd,QAAQ+B,KAAK,mCAAoCd,GAInDL,EAAQoB,KAAK,WAAY,CAAEC,SAAU,OAGhC,6BAIMC,cAAMC,KAAKzB","file":"static/js/20.3ecea176.chunk.js","sourcesContent":["import api from \"./API\";\n\nconst getProfile = () => {\n  return api.get(\"/user/getProfile\").then(\n    response => {\n      return response.data;\n    },\n    error => {\n      return error;\n    }\n  );\n};\n\nconst updateProfile = ({/*username, */email, password, firstName, lastName, address, fiscalCode, businessName}) => {\n  return api.post(\"/user/updateProfile\", {\n    //username,\n    email,\n    password,\n    firstName,\n    lastName,\n    address,\n    fiscalCode,\n    businessName,\n  }).then(\n    response => {\n      return response.data;\n    },\n    error => {\n      return error;\n    }\n  );\n};\n\nconst updateUserProperty = ({userId, propertyName, propertyValue}) => {\n  return api.post(\"/user/updateUserProperty\", {\n    userId,\n    propertyName,\n    propertyValue,\n  }).then(\n    response => {\n      return response.data;\n    },\n    error => {\n      return error;\n    }\n  );\n};\n\nconst getPlans = plans => {\n  return api.get(\"/user/getPlans\").then(\n    response => {\n      return response.data;\n    },\n    error => {\n      return error;\n    }\n  );\n};\n\nconst updatePlan = plan => {\n  console.log(\"updatePlan - plan:\", plan);\n  return api.post(\"/user/updatePlan\",\n    plan,\n  ).then(\n    response => {\n      return response.data;\n    },\n    error => {\n      return error;\n    }\n  );\n};\n\nconst getRoles = roles => {\n  return api.get(\"/user/getRoles\").then(\n    response => {\n      return response.data;\n    },\n    error => {\n      return error;\n    }\n  );\n};\n\nconst updateRoles = roles => {\n  return api.post(\"/user/updateRoles\",\n    roles,\n  ).then(\n    response => {\n      return response.data;\n    },\n    error => {\n      return error;\n    }\n  );\n};\n\nconst getPublicContent = () => {\n  return api.get(\"/test/all\");\n};\n\nconst getUserBoard = () => {\n  return api.get(\"/test/user\");\n};\n\nconst getModeratorBoard = () => {\n  return api.get(\"/test/mod\");\n};\n\nconst getAdminBoard = () => {\n  return api.get(\"/test/admin\");\n};\n\nconst getAdminPanel = () => {\n  return api.get(\"/admin/getAdminPanel\"\n  ).then(\n    (response) => {\n      return response.data;\n    },\n    (error) => {\n      return error;\n    }\n  );\n};\n\nconst UserService = {\n  getProfile,\n  updateProfile,\n  updateUserProperty,\n  getPlans,\n  updatePlan,\n  getRoles,\n  updateRoles,\n  getPublicContent,\n  getUserBoard,\n  getModeratorBoard,\n  getAdminBoard,\n  getAdminPanel,\n};\n\nexport default UserService;\n","import React, { useEffect } from \"react\";\nimport { useLocation, useHistory } from \"react-router-dom\";\nimport { useTranslation } from \"react-i18next\";\nimport UserService from \"../services/UserService\";\nimport { errorMessage } from \"../libs/Misc\";\nimport EventBus from \"../libs/EventBus\";\nimport { toast } from \"./Toast\";\n\nfunction PaymentRedirect(props) {\n  const history = useHistory();\n  const { t } = useTranslation();\n  const { pathname, search } = useLocation();\n\n  useEffect(() => {\n    const status =\n      pathname.match(\"/payment-success\") ? \"success\" :\n      pathname.match(\"/payment-cancel\") ? \"cancel\" :\n      \"unknown\"\n    ;\n    const queryParams = new URLSearchParams(search);\n    const planName = queryParams.get(\"product\");\n\n    if (status === \"success\") {\n      UserService.updatePlan({\n        plan: planName,\n      }).then(\n        result => {\n          if (result instanceof Error) {\n            console.error(\"profileUpdate error:\", result);\n            toast.error(errorMessage(result));\n            return; //setError({ code: result.message });\n          }\n          console.log(\"*** updatePlan result OK (user?):\", result);\n          EventBus.dispatch(\"plan-change\");\n          toast.success(t(\"Plan updated successfully\"));\n        }\n      );\n\n    } else {\n      console.warn(\"PaymentRedirect - path name was:\", pathname);\n    }\n\n    // redirect to profile, plans tab (2nd)\n    history.push(\"/profile\", { tabValue: 1 });\n  });\n\n  return <></>;\n}\n\n\nexport default React.memo(PaymentRedirect);"],"sourceRoot":""}